var theme={utilities:{hasClass:function(e,t){return-1<(" "+e.className+" ").indexOf(" "+t+" ")},extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},scrollTo:function(t,e,s){function n(){o+=20;var e=theme.utilities.easeInOutQuad(o,i,l,s);t.scrollTop=e,o<s&&setTimeout(n,20)}var i=t.scrollTop,l=e-i,o=0;n()},scrollToElement:function(e,t,s,n){var i;e&&e instanceof Node&&(t=t||0,s&&!isNaN(s)||(s=1),i=document.querySelector("html"),e=parseInt(parseInt(e.getBoundingClientRect().top)+parseInt(window.scrollY)-t),theme.utilities.scrollTo(i,e,s,n))},easeInOutQuad:function(e,t,s,n){return(e/=n/2)<1?s/2*e*e+t:-s/2*(--e*(e-2)-1)+t},serialize:function(e){var t,s=[];if("object"==typeof e&&"FORM"==e.nodeName){var n=e.elements.length;for(i=0;i<n;i++)if((t=e.elements[i]).name&&!t.disabled&&"file"!=t.type&&"reset"!=t.type&&"submit"!=t.type&&"button"!=t.type)if("select-multiple"==t.type)for(j=e.elements[i].options.length-1;0<=j;j--)t.options[j].selected&&(s[s.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.options[j].value));else("checkbox"!=t.type&&"radio"!=t.type||t.checked)&&(s[s.length]=encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}return s.join("&").replace(/%20/g,"+")},disableBodyScroll:function(){document.querySelector("body").classList.add("disable-scroll")},enableBodyScroll:function(){document.querySelector("body").classList.remove("disable-scroll")},insertBefore:function(e,t){e&&t&&t.parentNode.insertBefore(e,t)},insertAfter:function(e,t){e&&t&&t.parentNode.insertBefore(e,t.nextSibling)},prepend:function(e,t){if(e&&t)return t.insertBefore(e,t.firstChild),e},append:function(e,t){if(e&&t)return t.appendChild(e),e},remove:function(e){e&&e.parentNode.removeChild(e)},loadScript:function(e,t){var s;if(e)return(s=document.createElement("script")).type="text/javascript",s.src=e,s.onload=function(){"function"==typeof t&&t({scriptEl:s})},theme.utilities.append(s,document.querySelector("body")),s;console.warn("theme.utilities.loadScript(src) was called, but no src was specified")}},polyfills:{init:function(){this.polyfillClosest(),this.polyfillFetch(),"IntersectionObserver"in window||this.polyfillIntersectionObserver()},polyfillFetch:function(){var e,t;!window.MSInputMethodContext||!document.documentMode||((e=document.createElement("script")).type="text/javascript",e.src="https://cdn.jsdelivr.net/npm/promise-polyfill@8.1.3/dist/polyfill.min.js",(t=document.createElement("script")).type="text/javascript",t.src="https://cdn.jsdelivr.net/npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js",document.head.appendChild(e),document.head.appendChild(t))},polyfillIntersectionObserver:function(){!function(){"use strict";var m,s,f,v;function l(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function d(e){this.time=e.time,this.target=e.target,this.rootBounds=n(e.rootBounds),this.boundingClientRect=n(e.boundingClientRect),this.intersectionRect=n(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!e.intersectionRect;var e=this.boundingClientRect,e=e.width*e.height,t=this.intersectionRect,t=t.width*t.height;this.intersectionRatio=e?Number((t/e).toFixed(4)):this.isIntersecting?1:0}function e(e,t){var s,n,i,t=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(t.root&&1!=t.root.nodeType&&9!=t.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(s=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,i=null,function(){i=i||setTimeout(function(){s(),i=null},n)}),this._callback=e,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(t.rootMargin),this.thresholds=this._initThresholds(t.threshold),this.root=t.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function o(e,t,s,n){"function"==typeof e.addEventListener?e.addEventListener(t,s,n||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,s)}function r(e,t,s,n){"function"==typeof e.removeEventListener?e.removeEventListener(t,s,n||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,s)}function b(e){var t;try{t=e.getBoundingClientRect()}catch(e){}return t?t=t.width&&t.height?t:{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}:{top:0,bottom:0,left:0,right:0,width:0,height:0}}function n(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function S(e,t){var s=t.top-e.top,e=t.left-e.left;return{top:s,left:e,height:t.height,width:t.width,bottom:s+t.height,right:e+t.width}}function i(e,t){for(var s=t;s;){if(s==e)return!0;s=w(s)}return!1}function w(e){var t=e.parentNode;return 9==e.nodeType&&e!=m?l(e):(t=t&&t.assignedSlot?t.assignedSlot.parentNode:t)&&11==t.nodeType&&t.host?t.host:t}function a(e){return e&&9===e.nodeType}"object"==typeof window&&("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}}):(m=function(){for(var e=window.document,t=l(e);t;)t=l(e=t.ownerDocument);return e}(),s=[],v=f=null,e.prototype.THROTTLE_TIMEOUT=100,e.prototype.POLL_INTERVAL=null,e.prototype.USE_MUTATION_OBSERVER=!0,e._setupCrossOriginUpdater=function(){return f=f||function(e,t){v=e&&t?S(e,t):{top:0,bottom:0,left:0,right:0,width:0,height:0},s.forEach(function(e){e._checkForIntersections()})}},e._resetCrossOriginUpdater=function(){v=f=null},e.prototype.observe=function(t){if(!this._observationTargets.some(function(e){return e.element==t})){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},e.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._unmonitorIntersections(t.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},e.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},e.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},e.prototype._initThresholds=function(e){e=e||[0];return(e=Array.isArray(e)?e:[e]).sort().filter(function(e,t,s){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==s[t-1]})},e.prototype._parseRootMargin=function(e){e=(e||"0px").split(/\s+/).map(function(e){e=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(e)return{value:parseFloat(e[1]),unit:e[2]};throw new Error("rootMargin must be specified in pixels or percent")});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},e.prototype._monitorIntersections=function(t){var s,n,i,e=t.defaultView;e&&-1==this._monitoringDocuments.indexOf(t)&&(s=this._checkForIntersections,i=n=null,this.POLL_INTERVAL?n=e.setInterval(s,this.POLL_INTERVAL):(o(e,"resize",s,!0),o(t,"scroll",s,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in e&&(i=new e.MutationObserver(s)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(t),this._monitoringUnsubscribes.push(function(){var e=t.defaultView;e&&(n&&e.clearInterval(n),r(e,"resize",s,!0)),r(t,"scroll",s,!0),i&&i.disconnect()}),e=this.root&&(this.root.ownerDocument||this.root)||m,t!=e)&&(e=l(t))&&this._monitorIntersections(e.ownerDocument)},e.prototype._unmonitorIntersections=function(n){var i,e,t=this._monitoringDocuments.indexOf(n);-1!=t&&(i=this.root&&(this.root.ownerDocument||this.root)||m,this._observationTargets.some(function(e){var t=e.element.ownerDocument;if(t==n)return!0;for(;t&&t!=i;){var s=l(t);if((t=s&&s.ownerDocument)==n)return!0}return!1})||(e=this._monitoringUnsubscribes[t],this._monitoringDocuments.splice(t,1),this._monitoringUnsubscribes.splice(t,1),e(),n!=i&&(t=l(n))&&this._unmonitorIntersections(t.ownerDocument)))},e.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;for(var t=this._monitoringUnsubscribes.length=0;t<e.length;t++)e[t]()},e.prototype._checkForIntersections=function(){var r,a;(this.root||!f||v)&&(r=this._rootIsInDom(),a=r?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0},this._observationTargets.forEach(function(e){var t=e.element,s=b(t),n=this._rootContainsTarget(t),i=e.entry,l=r&&n&&this._computeTargetAndRootIntersection(t,s,a),o=null,e=(this._rootContainsTarget(t)?f&&!this.root||(o=a):o={top:0,bottom:0,left:0,right:0,width:0,height:0},e.entry=new d({time:window.performance&&performance.now&&performance.now(),target:t,boundingClientRect:s,rootBounds:o,intersectionRect:l}));i?r&&n?this._hasCrossedThreshold(i,e)&&this._queuedEntries.push(e):i&&i.isIntersecting&&this._queuedEntries.push(e):this._queuedEntries.push(e)},this),this._queuedEntries.length)&&this._callback(this.takeRecords(),this)},e.prototype._computeTargetAndRootIntersection=function(e,t,s){if("none"!=window.getComputedStyle(e).display){for(var n,i,l,o,r=t,a=w(e),d=!1;!d&&a;){var c,u,h,p=null,g=1==a.nodeType?window.getComputedStyle(a):{};if("none"==g.display)return null;if(a==this.root||9==a.nodeType?(d=!0,a==this.root||a==m?f&&!this.root?!v||0==v.width&&0==v.height?r=p=a=null:p=v:p=s:(c=(h=w(a))&&b(h),u=h&&this._computeTargetAndRootIntersection(h,c,s),c&&u?(a=h,p=S(c,u)):r=a=null)):a!=(h=a.ownerDocument).body&&a!=h.documentElement&&"visible"!=g.overflow&&(p=b(a)),p&&(c=p,u=r,g=Math.max(c.top,u.top),p=Math.min(c.bottom,u.bottom),n=Math.max(c.left,u.left),o=p-g,r=0<=(l=(i=Math.min(c.right,u.right))-n)&&0<=o?{top:g,bottom:p,left:n,right:i,width:l,height:o}:null),!r)break;a=a&&w(a)}return r}},e.prototype._getRootRect=function(){var e,t;return t=this.root&&!a(this.root)?b(this.root):(t=(e=a(this.root)?this.root:m).documentElement,e=e.body,{top:0,left:0,right:t.clientWidth||e.clientWidth,width:t.clientWidth||e.clientWidth,bottom:t.clientHeight||e.clientHeight,height:t.clientHeight||e.clientHeight}),this._expandRectByRootMargin(t)},e.prototype._expandRectByRootMargin=function(s){var e=this._rootMarginValues.map(function(e,t){return"px"==e.unit?e.value:e.value*(t%2?s.width:s.height)/100}),e={top:s.top-e[0],right:s.right+e[1],bottom:s.bottom+e[2],left:s.left-e[3]};return e.width=e.right-e.left,e.height=e.bottom-e.top,e},e.prototype._hasCrossedThreshold=function(e,t){var s=e&&e.isIntersecting?e.intersectionRatio||0:-1,n=t.isIntersecting?t.intersectionRatio||0:-1;if(s!==n)for(var i=0;i<this.thresholds.length;i++){var l=this.thresholds[i];if(l==s||l==n||l<s!=l<n)return!0}},e.prototype._rootIsInDom=function(){return!this.root||i(m,this.root)},e.prototype._rootContainsTarget=function(e){var t=this.root&&(this.root.ownerDocument||this.root)||m;return i(t,e)&&(!this.root||t==e.ownerDocument)},e.prototype._registerInstance=function(){s.indexOf(this)<0&&s.push(this)},e.prototype._unregisterInstance=function(){var e=s.indexOf(this);-1!=e&&s.splice(e,1)},window.IntersectionObserver=e,window.IntersectionObserverEntry=d))}()},polyfillClosest:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}})}},loading:{els:{root:null},init:function(){return this.els.root=document.querySelector(".loading-overlay"),this},show:function(){!this.els.root||this.els.root.length<=0||this.els.root.classList.remove("hide")},hide:function(){!this.els.root||this.els.root.length<=0||this.els.root.classList.add("hide")}},inputs:{inst:null,els:{numericInputs:null},init:function(){return(inst=this).initNumeric(),this},initNumeric:function(){this.els.numericInputs=document.querySelectorAll('input[data-numeric="true"]');for(var e=0;e<this.els.numericInputs.length;++e)this.els.numericInputs[e].addEventListener("keypress",function(e){isNaN(e.key)&&"."!=e.key&&(e.stopPropagation(),e.preventDefault())});for(e=0;e<this.els.numericInputs.length;++e)this.els.numericInputs[e].addEventListener("change",function(e){var t,s,n=parseFloat(e.target.value),i=e.target.dataset.min,l=e.target.dataset.max;isNaN(n)||void 0===i&&void 0===l||(t=void 0===i?"undefined":-1!==i.indexOf(".")?"float":"int",s=void 0===l?"undefined":-1!==l.indexOf(".")?"float":"int","undefined"!=t&&n<(i="int"==t?parseInt(i):parseFloat(i).toFixed(2))?e.target.value=i:"undefined"!=s&&(l="int"==s?parseInt(l):parseFloat(l).toFixed(2))<n&&(e.target.value=l))})}},rangeSliders:{instances:[],instantiate:function(e){if(e)if(theme&&!theme.utilities.hasClass(e,"range-slider"))console.error("rangeSlidersPlugin.instantiate(rootEl) was called but rootEl does not have class of range-slider.");else{e={settings:{prefix:"",showMarkers:!0},els:{rootEl:null,fromToWrapEl:null,fromEl:null,toEl:null,markers:{rootEl:null,fromValueWrapEl:null,fromValueEl:null,toValueWrapEl:null,toValueEl:null,valueWrapEl:null,valueEl:null}},init:function(e,t){var s=this,n=(this.els.rootEl=e,this.els.rootEl.querySelectorAll('input[type="range"]'));if(2==n.length)return this.els.fromEl=n[0],this.els.toEl=n[1],t||(t={},e.dataset.prefix&&(t.prefix=e.dataset.prefix),e.dataset.showMarkers&&-1!==["true","false"].indexOf(e.dataset.showMarkers)&&(t.showMarkers="true"===e.dataset.showMarkers)),this.settings=theme.utilities.extend(this.settings,t),this.wrapFromAndToEls(),this.settings.showMarkers&&(this.generateMarkers(),this.updateMarkerValue()),this.toggleToSliderThumbAccessibility(),this.els.fromEl.addEventListener("input",function(e){s.handleInputFromEl(e)}),this.els.toEl.addEventListener("input",function(e){s.handleInputToEl(e)}),this},wrapFromAndToEls:function(){this.els.fromToWrapEl=document.createElement("div"),this.els.fromToWrapEl.classList.add("range-slider-input-wrap"),theme.utilities.append(this.els.fromToWrapEl,this.els.rootEl),theme.utilities.append(this.els.fromEl,this.els.fromToWrapEl),theme.utilities.append(this.els.toEl,this.els.fromToWrapEl)},generateMarkers:function(){this.els.markers.rootEl=document.createElement("div"),this.els.markers.rootEl.classList.add("range-slider-markers","cols","no-wrap"),theme.utilities.append(this.els.markers.rootEl,this.els.rootEl),this.els.markers.fromValueWrapEl=document.createElement("div"),this.els.markers.fromValueWrapEl.classList.add("left","range-slider-marker-from"),theme.utilities.append(this.els.markers.fromValueWrapEl,this.els.markers.rootEl),this.els.markers.fromValueEl=document.createElement("div"),this.els.markers.fromValueEl.innerHTML=this.settings.prefix+this.els.fromEl.min,theme.utilities.append(this.els.markers.fromValueEl,this.els.markers.fromValueWrapEl),this.els.markers.valueWrapEl=document.createElement("div"),this.els.markers.valueWrapEl.classList.add("expand","center","range-slider-marker-value"),theme.utilities.append(this.els.markers.valueWrapEl,this.els.markers.rootEl),this.els.markers.valueEl=document.createElement("div"),this.els.markers.valueEl.innerHTML="",theme.utilities.append(this.els.markers.valueEl,this.els.markers.valueWrapEl),this.els.markers.toValueWrapEl=document.createElement("div"),this.els.markers.toValueWrapEl.classList.add("right","range-slider-marker-to"),theme.utilities.append(this.els.markers.toValueWrapEl,this.els.markers.rootEl),this.els.markers.toValueEl=document.createElement("div"),this.els.markers.toValueEl.innerHTML=this.settings.prefix+this.els.toEl.max,theme.utilities.append(this.els.markers.toValueEl,this.els.markers.toValueWrapEl)},updateMarkerValue:function(){this.els.markers.valueEl.innerHTML=this.settings.prefix+this.els.fromEl.value+" - "+this.settings.prefix+this.els.toEl.value},toggleToSliderThumbAccessibility:function(){0==parseInt(this.els.toEl.value)?this.els.toEl.classList.add("range-slider-handle-accessible"):this.els.toEl.classList.remove("range-slider-handle-accessible")},setFromValue:function(e){isNaN(e)&&console.warn("setFromValue(value) was called, but a non-numeric value was given");var t=parseInt(this.els.fromEl.min),s=parseInt(this.els.toEl.value);e<t?e=t:s<e&&(e=s),this.els.fromEl.value=e},setToValue:function(e){isNaN(e)&&console.warn("setToValue(value) was called, but a non-numeric value was given");var t=parseInt(this.els.fromEl.value),s=parseInt(this.els.toEl.max);e<t?e=t:s<e&&(e=s),this.els.toEl.value=e},handleInputFromEl:function(e){this.setFromValue(e.target.value),this.toggleToSliderThumbAccessibility(),this.settings.showMarkers&&this.updateMarkerValue()},handleInputToEl:function(e){this.setToValue(e.target.value),this.toggleToSliderThumbAccessibility(),this.settings.showMarkers&&this.updateMarkerValue()}}.init(e);if(e)return this.instances.push(e),e;console.warn("rangeSlidersPlugin.instantiate(rootEl) failed to create an instance.")}else console.error("rangeSlidersPlugin.instantiate(rootEl) was called but no rootEl was given.")},init:function(){for(var e=document.querySelectorAll(".range-slider"),t=0;t<e.length;++t)this.instantiate(e[t]);return this}},search:{els:{root:null,form:null,input:null,showTriggers:null,hideTriggers:null},init:function(){var t=this;this.els.root=document.querySelector(".searchbox"),this.els.form=this.els.root.querySelector("form"),this.els.input=this.els.root.querySelector("input"),this.els.showTriggers=document.querySelectorAll(".onclick-show-search"),this.els.hideTriggers=document.querySelectorAll(".onclick-hide-search");for(var e=0;e<this.els.showTriggers.length;++e)this.els.showTriggers[e].addEventListener("click",function(){t.show()});for(e=0;e<this.els.hideTriggers.length;++e)this.els.hideTriggers[e].addEventListener("click",function(){t.hide()});return document.addEventListener("keyup",function(e){"Escape"==e.key&&t.hide()}),this.els.root.addEventListener("click",function(e){t.els.form.contains(e.target)||t.hide()}),this},show:function(){this.els.root?(this.els.root.classList.add("active"),this.els.input.focus()):console.warn("theme.search.show() was called, but no root element was found for .searchbox")},hide:function(){this.els.root.classList?(this.els.root.classList.remove("active"),this.els.input.blur()):console.warn("theme.search.hide() was called, but no root element was found for .searchbox")}},searchPredictor:{settings:{shopId:0},instances:[],init:function(e){if(e&&(this.settings=theme.utilities.extend(this.settings,e)),isNaN(this.settings.shopId)||this.settings.shopId<=0)console.warn("theme.searchPredictor.init(options) was called, but an invalid shopId was given.");else for(var t=document.querySelectorAll(".search-predictor"),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]))},instantiate:function(e){return{els:{root:null,form:null,searchInput:null,results:[]},listeners:{changeSelectedIndex:[]},searchStringTimeout:null,lastSearch:"",selectedIndex:-1,init:function(){var s=this;this.els.root=e,this.els.form=this.els.root.closest("form"),this.els.form?(this.els.searchInput=this.els.form.querySelector("input[name=search_string]"),this.els.searchInput.addEventListener("keyup",function(e){e.currentTarget.value!=s.lastSearch&&(s.lastSearch=e.currentTarget.value,clearTimeout(s.searchStringTimeout),s.searchStringTimeout=setTimeout(function(){!s.els.searchInput.value||s.els.searchInput.value.length<3?s.clearResults():s.doAjaxSearchPredictor(s.els.searchInput.value,function(e){s.renderResults(e.results)})},600))}),document.addEventListener("keypress",function(e){var t;window.event?t=e.keyCode:e.which?t=e.which:e.key&&(t=e.key),13!=t||s.els.results.length<=0||-1!=s.selectedIndex&&(0<(t=s.els.results[s.selectedIndex].querySelector("a")).dataset.predictorTarget.length?window.location.href=t.dataset.predictorTarget:(s.els.searchInput.value=t.innerHTML,s.els.form.submit()),e.stopPropagation(),e.preventDefault())}),document.addEventListener("keyup",function(e){var t;window.event?t=e.keyCode:e.which?t=e.which:e.key&&(t=e.key),40!=t||s.els.results.length<=0||((e=s.selectedIndex+1)>s.els.results.length-1&&(e=0),s.setSelectedIndex(e))}),document.addEventListener("keyup",function(e){var t;window.event?t=e.keyCode:e.which?t=e.which:e.key&&(t=e.key),38!=t||s.els.results.length<=0||((e=s.selectedIndex-1)<0&&(e=s.els.results.length-1),s.setSelectedIndex(e))}),document.addEventListener("keyup",function(e){var t;window.event?t=e.keyCode:e.which?t=e.which:e.key&&(t=e.key),27!=t||s.els.results.length<=0||s.clearResults()}),s.on("changeSelectedIndex",function(e){-1<e.lastIndex&&s.els.results[e.lastIndex].classList.remove("active"),-1<e.index&&s.els.results[e.index].classList.add("active")})):console.warn("theme.searchPredictor.init(rootEl) was called but rootEl is not within a form element.")},setSelectedIndex:function(e){(isNaN(e)||e>this.els.results.length-1||e<-1)&&(e=-1);var t=this.selectedIndex;if(-1!=(this.selectedIndex=e))for(var s=0;s<this.listeners.changeSelectedIndex.length;++s)this.listeners.changeSelectedIndex[s]({index:e,lastIndex:t})},clearResults:function(){for(var e=0;e<this.els.results.length;++e)theme.utilities.remove(this.els.results[e]);this.els.results=[],this.setSelectedIndex(-1),this.els.root.classList.add("force-hide")},doAjaxSearchPredictor:function(e,t){!theme.searchPredictor.settings.shopId||!e||e.length<3||(e="/ajax/?action=search-predictor&shop_id="+theme.searchPredictor.settings.shopId+"&predictor_text="+encodeURIComponent(e),fetch(e,{method:"GET"}).then(function(e){return e.text()}).then(function(e){e=JSON.parse(e),"function"==typeof t&&t({results:e||[]})}))},renderResults:function(e){if(this.clearResults(),e&&!(e.length<=0)){for(var t=0;t<e.length;++t)this.renderResult(e[t]);this.els.root.classList.remove("force-hide")}},renderResult:function(t){var s=this,e=document.createElement("div"),n=(e.classList.add("search-predictor-result"),document.createElement("a"));n.href=t.predictor_target,n.innerHTML=t.predictor_text,n.dataset.predictorTarget=t.predictor_target,theme.utilities.append(n,e),t.predictor_target||n.addEventListener("click",function(e){s.els.searchInput.value=t.predictor_text,s.els.form.submit(),e.stopPropagation(),e.preventDefault()}),theme.utilities.append(e,this.els.root),this.els.results.push(e)},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.searchPredictor.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.searchPredictor.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init()}},triggeredContent:{instances:[],init:function(){for(var e=document.querySelectorAll(".triggered-content"),t=0;t<e.length;++t)this.instances.push(this.instantiate(e[t]))},instantiate:function(e){return{els:{root:null,trigger:null,box:null},init:function(){var t=this;return this.els.root=e,this.els.trigger=this.els.root.querySelector(".trigger"),this.els.box=this.els.root.querySelector(".box"),this.els.trigger.addEventListener("click",function(){t.show()}),document.addEventListener("keyup",function(e){"Escape"==e.key&&t.hide()}),document.addEventListener("click",function(e){t.els.root.contains(e.target)||t.hide()}),this},show:function(){this.els.root.classList.add("active")},hide:function(){this.els.root.classList.remove("active")}}.init()}},ajaxProductList:{settings:{useHistory:!1,productListRootSelector:".product-card-list-wrap",noProductsFoundSelector:".no-products-found"},els:{productListRoot:null,noProductsFound:null,responseHelper:null},listeners:{fetchProducts:[],fetchProductsBegin:[]},init:function(e){this.settings=theme.utilities.extend(this.settings,e),this.setProductListRoot(this.settings.productListRootSelector),this.els.noProductsFound=document.querySelector(this.settings.noProductsFoundSelector),this.settings.useHistory&&(this.on("fetchProductsBegin",function(e){history.state||history.replaceState({url:window.location.href},"")}),this.on("fetchProducts",function(e){history.pushState({url:e.url},"",e.url)}),window.addEventListener("popstate",function(e){e.state.url&&(window.location.href=e.state.url)}))},setProductListRoot:function(e){var t;e?(this.settings.productListRootSelector=e,!(t=document.querySelector(e))||t.length<=0?console.warn("theme.ajaxProductList.setProductListRoot(selector) was called, but no element was found for the given selector ("+e+")"):this.els.productListRoot=t):console.warn("theme.ajaxProductList.setResultsRoot(selector) was called, but no selector was specified.")},doSubmit:function(){var e=null,n=window.location.href.split("?")[0];0<theme.productFilters.instances.length&&theme.productFilters.hasChanged&&(e=theme.utilities.serialize(theme.productFilters.instances[0].els.formEl))&&(n=n+(-1===n.indexOf("?")?"?":"&")+e),0<theme.sorting.instances.length&&(e=theme.utilities.serialize(theme.sorting.instances[0].els.formEl))&&(n=n+(-1===n.indexOf("?")?"?":"&")+e),0<theme.paging.instances.length&&(e=theme.utilities.serialize(theme.paging.instances[0].els.formEl))&&(n=n+(-1===n.indexOf("?")?"?":"&")+e),theme.loading.show();for(var t=0;t<theme.ajaxProductList.listeners.fetchProductsBegin.length;++t)theme.ajaxProductList.listeners.fetchProductsBegin[t]({url:n});fetch(n,{method:"GET"}).then(function(e){return e.text()}).then(function(e){setTimeout(function(){theme.loading.hide()},200),theme.ajaxProductList.els.responseHelper||(theme.ajaxProductList.els.responseHelper=document.createElement("div")),theme.ajaxProductList.els.responseHelper.innerHTML=e;var t=theme.ajaxProductList.els.responseHelper.querySelector(theme.ajaxProductList.settings.productListRootSelector);!t||t.length<=0?(theme.ajaxProductList.showNoResults(),theme.ajaxProductList.hideProducts()):(theme.ajaxProductList.hideNoResults(),theme.ajaxProductList.showProducts(),theme.utilities.insertBefore(t,theme.ajaxProductList.els.productListRoot),theme.utilities.remove(theme.ajaxProductList.els.productListRoot),theme.ajaxProductList.els.productListRoot=t);for(var s=0;s<theme.ajaxProductList.listeners.fetchProducts.length;++s)theme.ajaxProductList.listeners.fetchProducts[s]({url:n,responseHelper:theme.ajaxProductList.els.responseHelper,results:t||[]})})},showNoResults:function(){!this.els.noProductsFound||this.els.noProductsFound.length<=0||this.els.noProductsFound.classList.remove("hide")},hideNoResults:function(){!this.els.noProductsFound||this.els.noProductsFound.length<=0||this.els.noProductsFound.classList.add("hide")},showProducts:function(){!this.els.productListRoot||this.els.productListRoot.length<=0||this.els.productListRoot.classList.remove("hide")},hideProducts:function(){!this.els.productListRoot||this.els.productListRoot.length<=0||this.els.productListRoot.classList.add("hide")},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.ajaxProductList.on(eventName, callback) was called, but no callback function was given."):console.warn("theme.ajaxProductList.on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}},productFilters:{settings:{ajaxResults:!0},instances:[],els:{},listeners:{changeFilters:[]},hasChanged:!1,init:function(e){this.settings=theme.utilities.extend(this.settings,e);for(var t=document.querySelectorAll("form[name=productFilters]"),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]));return this},instantiate:function(s){if(s&&"FORM"==s.tagName)return{els:{formEl:null,checkboxes:null,radios:null,inputs:null,buttons:null},submitTimeout:null,init:function(){var t=this;t.els.formEl=s,t.els.checkboxes=t.els.formEl.querySelectorAll('input[type="checkbox"]'),t.els.radios=t.els.formEl.querySelectorAll('input[type="radio"]'),t.els.inputs=t.els.formEl.querySelectorAll('input[type="text"], input[type="tel"], input[type="range"]'),t.els.buttons=t.els.formEl.querySelectorAll("button"),t.els.formEl.addEventListener("submit",function(e){e.stopPropagation(),e.preventDefault(),t.doSubmit()});for(var e=0;e<t.els.checkboxes.length;++e)t.els.checkboxes[e].addEventListener("change",function(e){t.setHasChanged(!0),theme.productFilters.syncInstances(t),t.cancelSubmit(),t.isAutoSubmitDisabled()||t.submitWithDelay()});for(e=0;e<t.els.radios.length;++e)t.els.radios[e].addEventListener("change",function(e){t.setHasChanged(!0),theme.productFilters.syncInstances(t),t.cancelSubmit(),t.isAutoSubmitDisabled()||t.submitWithDelay()});for(e=0;e<t.els.inputs.length;++e)t.els.inputs[e].addEventListener("change",function(e){t.setHasChanged(!0),theme.productFilters.syncInstances(t),t.cancelSubmit(),t.isAutoSubmitDisabled()||t.submitWithDelay()});return this},cancelSubmit:function(){clearTimeout(this.submitTimeout)},submitWithDelay:function(e){var t=this;(void 0===e||isNaN(e)||e<0)&&(e=600),t.submitTimeout=setTimeout(function(){t.doSubmit()},e)},doSubmit:function(){for(var e=0;e<theme.productFilters.listeners.changeFilters.length;++e)theme.productFilters.listeners.changeFilters[e]();theme.productFilters.settings.ajaxResults?theme.ajaxProductList.doSubmit():this.els.formEl.submit()},setHasChanged:function(e){theme.productFilters.hasChanged=!!e},isAutoSubmitDisabled:function(){return void 0!==this.els.formEl.dataset.disableAutoSubmitOnChange&&"1"==this.els.formEl.dataset.disableAutoSubmitOnChange}}.init();console.warn("theme.productFilters.instantiate(formEl) was called, but no form element was given.")},syncInstances:function(e){if(e&&-1!==this.instances.indexOf(e))for(var t,s=0;s<this.instances.length;++s)this.instances[s]!=e&&(t=this.instances[s],this.syncCheckboxes(t,e.els.checkboxes),this.syncRadios(t,e.els.radios),this.syncInputs(t,e.els.inputs));else console.warn("theme.productFilters.syncInstances(instance) was called, but an invalid instance was specified",e)},syncCheckboxes:function(e,t){if(e)if(!t||t.length<=0)console.warn("theme.productFilters.syncCheckboxes(instance, checkboxes) was called, but an invalid checkboxes array was specified.",t);else if(e.els.checkboxes.length!=t.length)console.warn("theme.productFilters.syncCheckboxes(instance, checkboxes) was called, but instance.els.checkboxes.length ("+e.els.checkboxes.length+") is different to checkboxes.length ("+t.length+").");else for(var s=0;s<t.length;++s)e.els.checkboxes[s].checked=t[s].checked;else console.warn("theme.productFilters.syncCheckboxes(instance, checkboxes) was called, but an invalid instance was specified.",e)},syncRadios:function(e,t){if(e)if(!t||t.length<=0)console.warn("theme.productFilters.syncRadios(instance, radios) was called, but an invalid radios array was specified.",t);else if(e.els.radios.length!=t.length)console.warn("theme.productFilters.syncRadios(instance, radios) was called, but instance.els.radios.length ("+e.els.radios.length+") is different to radios.length ("+t.length+").");else for(var s=0;s<t.length;++s)e.els.radios[s].checked=t[s].checked;else console.warn("theme.productFilters.syncRadios(instance, radios) was called, but an invalid instance was specified.",e)},syncInputs:function(e,t){if(e)if(!t||t.length<=0)console.warn("theme.productFilters.syncInputs(instance, inputs) was called, but an invalid inputs array was specified.",t);else if(e.els.inputs.length!=t.length)console.warn("theme.productFilters.syncInputs(instance, inputs) was called, but instance.els.inputs.length ("+e.els.inputs.length+") is different to inputs.length ("+t.length+").");else for(var s=0;s<t.length;++s)e.els.inputs[s].value=t[s].value;else console.warn("theme.productFilters.syncInputs(instance, inputs) was called, but an invalid instance was specified.",e)},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.productFilters.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.productFilters.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}},sorting:{settings:{},instances:[],els:{},init:function(e){this.settings=theme.utilities.extend(this.settings,e);for(var t=document.querySelectorAll("form[name=sortProducts]"),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]));return theme.ajaxProductList.on("fetchProducts",function(e){e.results.length<=0?theme.sorting.hideSorting():theme.sorting.showSorting()}),this},instantiate:function(e){if(e&&"FORM"==e.tagName)return{els:{formEl:null,select:null},init:function(){var t=this;return t.els.formEl=e,t.els.select=t.els.formEl.querySelector('select[name="product_sort_type"]'),t.els.formEl&&t.els.formEl.addEventListener("submit",function(e){e.stopPropagation(),e.preventDefault(),t.doSubmit()}),t.els.select&&t.els.select.addEventListener("change",function(){theme.sorting.syncInstances(t),t.isAutoSubmitDisabled()||t.doSubmit()}),this},doSubmit:function(){theme.ajaxProductList.doSubmit()},isAutoSubmitDisabled:function(){return void 0!==this.els.formEl.dataset.disableAutoSubmitOnChange&&"1"==this.els.formEl.dataset.disableAutoSubmitOnChange}}.init();console.warn("theme.sorting.instantiate(formEl) was called, but no form element was given.")},syncInstances:function(e){if(e&&-1!==this.instances.indexOf(e))for(var t=0;t<this.instances.length;++t)this.instances[t]!=e&&(this.instances[t].els.select.selectedIndex=e.els.select.selectedIndex);else console.warn("theme.sorting.syncInstances(instance) was called, but an invalid instance was specified",e)},showSorting:function(){for(var e=0;e<this.instances.length;++e)this.instances[e].els.formEl.classList.remove("hide")},hideSorting:function(){for(var e=0;e<this.instances.length;++e)this.instances[e].els.formEl.classList.add("hide")}},paging:{settings:{currentPageText:"Page [page] of [pageCount]"},instances:[],els:{},page:1,pageCount:0,perPage:0,listeners:{setPage:[],setPageCount:[],setPerPage:[]},submitTimeout:null,init:function(e){for(var t=this,s=(this.settings=theme.utilities.extend(this.settings,e),document.querySelectorAll("form[name=pagingProducts]")),n=0;n<s.length;++n)this.instances.push(this.instantiate(s[n]));return theme.productFilters.on("changeFilters",function(){theme.paging.page=1,0<theme.paging.instances.length&&(theme.paging.instances[0].els.currentPageEl.value=1),theme.paging.syncInstances()}),theme.ajaxProductList.on("fetchProducts",function(e){e.responseHelper&&(e.results.length<=0?(theme.paging.setPageCount(0),theme.paging.syncInstances()):(e=e.responseHelper.querySelector("form[name=pagingProducts]"))&&e.dataset.pageCount&&(theme.paging.setPageCount(parseInt(e.dataset.pageCount)),theme.paging.syncInstances()))}),theme.paging.on("setPage",function(e){theme.paging.syncInstances(),clearTimeout(t.submitTimeout),t.submitTimeout=setTimeout(function(){theme.paging.doSubmit()},400)}),theme.paging.on("setPerPage",function(e){theme.paging.syncInstances(),clearTimeout(t.submitTimeout),t.submitTimeout=setTimeout(function(){theme.paging.doSubmit()},400)}),this},instantiate:function(e){if(e&&"FORM"==e.tagName)return{els:{formEl:null,productsPerPageEl:null,currentPageEl:null,prevButton:null,nextButton:null,currentPageText:null},init:function(){var t=this;return t.els.formEl=e,t.els.productsPerPageEl=e.querySelector("[name=products_per_page]"),t.els.currentPageEl=e.querySelector("input[name=page]"),t.els.prevButton=e.querySelector("button[name=prevPage]"),t.els.nextButton=e.querySelector("button[name=nextPage]"),t.els.currentPageText=e.querySelector(".current-page-text"),theme.paging.on("setPage",function(e){e.page<=1?t.els.prevButton.disabled=!0:t.els.prevButton.disabled=!1,e.page>=theme.paging.pageCount?t.els.nextButton.disabled=!0:t.els.nextButton.disabled=!1}),theme.paging.on("setPageCount",function(e){e.pageCount<=1?(t.els.prevButton.disabled=!0,t.els.nextButton.disabled=!0,theme.paging.hidePaging()):(t.els.prevButton.disabled=e.page<=1,t.els.nextButton.disabled=e.pageCount<=e.page,theme.paging.showPaging())}),theme.paging.setPageCount(parseInt(this.els.formEl.dataset.pageCount)),theme.paging.setPage(parseInt(t.els.currentPageEl.value)),theme.paging.setPerPage(t.els.productsPerPageEl.value),t.els.prevButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),1!=theme.paging.page&&theme.paging.setPage(theme.paging.page-1)}),t.els.nextButton.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),theme.paging.page>=theme.paging.pageCount||theme.paging.setPage(theme.paging.page+1)}),t.els.productsPerPageEl&&t.els.productsPerPageEl.addEventListener("change",function(e){theme.paging.setPerPage(e.target.value),theme.paging.setPage(1)}),t.els.formEl&&t.els.formEl.addEventListener("submit",function(e){e.stopPropagation(),e.preventDefault(),theme.paging.syncInstances(t),t.doSubmit()}),this}}.init();console.warn("theme.paging.instantiate(formEl) was called, but no form element was given.")},getPageNo:function(){return this.page},getPerPage:function(){return this.perPage},setPageCount:function(e){if(void 0===e||isNaN(e))console.warn("theme.paging.setPageCount(pageCount) was called, but a non-numeric page count was specified");else{this.pageCount=parseInt(e);for(var t=0;t<this.listeners.setPageCount.length;++t)this.listeners.setPageCount[t]({page:theme.paging.page,pageCount:e})}},setPage:function(e){if(void 0===e||isNaN(e))console.warn("theme.paging.setPage(page) was called, but a non-numeric page was specified");else if(e<1||e>this.pageCount)console.warn("theme.paging.setPage(page) was called, but the specified page number ("+e+") is out of range. Page count is: "+this.pageCount);else{this.page=parseInt(e);for(var t=0;t<this.listeners.setPage.length;++t)this.listeners.setPage[t]({page:e,pageCount:theme.paging.pageCount})}},setPerPage:function(e){if(void 0===e)console.warn("theme.paging.setPerPage(perPage) was called, but no value was specified.");else{this.perPage=isNaN(parseInt(e))?e:parseInt(e);for(var t=0;t<this.listeners.setPerPage.length;++t)this.listeners.setPerPage[t]({perPage:this.perPage})}},syncInstances:function(){for(var e=0;e<this.instances.length;++e){if("SELECT"==this.instances[e].els.productsPerPageEl.nodeName){for(var t=0;t<this.instances[e].els.productsPerPageEl.options.length;++t)if(!this.instances[e].els.productsPerPageEl.options[t].disabled&&this.instances[e].els.productsPerPageEl.options[t].value==this.perPage){this.instances[e].els.productsPerPageEl.selectedIndex=t;break}}else this.instances[e].els.productsPerPageEl.value=this.perPage;this.instances[e].els.currentPageEl.value=this.page,this.instances[e].els.currentPageText.innerHTML=this.settings.currentPageText.replace("[page]",this.page).replace("[pageCount]",this.pageCount)}},doSubmit:function(){theme.ajaxProductList.doSubmit()},showPaging:function(){for(var e=0;e<this.instances.length;++e)this.instances[e].els.formEl.classList.remove("hide")},hidePaging:function(){for(var e=0;e<this.instances.length;++e)this.instances[e].els.formEl.classList.add("hide")},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.paging.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.paging.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}},tabbedContent:{instances:[],init:function(){for(var e=document.querySelectorAll(".tabbed-content"),t=0;t<e.length;++t)this.instances.push(this.instantiate(e[t]));return this},instantiate:function(s){if(s&&!(s.length<=0))return{els:{root:null,tabs:[],content:[],contentTabs:[]},selectedIndex:-1,selectedStackedTabIndex:-1,init:function(){var t=this;t.els.root=s,t.els.tabs=s.querySelectorAll(":scope > .tabs > div"),t.els.content=s.querySelectorAll(":scope > .content > div"),t.els.contentTabs=s.querySelectorAll(":scope > .content > div > .tab"),t.selectNormalTabAtIndex(0);for(var e=0;e<t.els.tabs.length;++e)t.els.tabs[e].addEventListener("click",function(e){e=[].indexOf.call(t.els.tabs,e.target);t.selectNormalTabAtIndex(e)});for(e=0;e<t.els.contentTabs.length;++e)t.els.contentTabs[e].addEventListener("click",function(e){e=[].indexOf.call(t.els.contentTabs,e.target);t.selectStackedTabAtIndex(e),t.selectNormalTabAtIndex(e)});return t},selectNormalTabAtIndex:function(e){this.els.tabs.length<=0||(void 0===e||isNaN(e)||e<0||e>this.els.tabs.length-1?console.warn("selectNormalTabAtIndex(index) was called, but an invalid index was given.  Must be an int which is in range.",e):(-1<this.selectedIndex&&(this.els.tabs[this.selectedIndex].classList.remove("normal-active"),this.els.content[this.selectedIndex].classList.remove("normal-active"),this.els.content[this.selectedIndex].classList.remove("stacked-active")),this.els.tabs[e].classList.add("normal-active"),this.els.content[e].classList.add("normal-active"),this.selectedIndex=e))},selectStackedTabAtIndex:function(e){var t,s=this;this.els.contentTabs.length<=0||((void 0===e||isNaN(e)||e<0||e>s.els.contentTabs.length-1)&&console.warn("selectStackedTabAtIndex(index) was called, but an invalid index was given.  Must be an int which is in range.",e),t=e==s.selectedStackedTabIndex&&theme.utilities.hasClass(s.els.content[e],"stacked-active"),-1<s.selectedStackedTabIndex&&s.els.content[s.selectedStackedTabIndex].classList.remove("stacked-active"),t?s.els.content[e].classList.remove("stacked-active"):setTimeout(function(){s.els.content[e].classList.add("stacked-active")},1),this.selectedStackedTabIndex=e)}}.init()},getInstanceByRootEl:function(e){for(var t=0;t<this.instances.length;++t)if(this.instances[t].els.root===e)return this.instances[t]}},imageGalleries:{settings:{navigationNextClassName:"swiper-button-next",navigationPrevClassName:"swiper-button-prev"},instances:[],init:function(e){e&&(this.settings=theme.utilities.extend(this.settings,e));for(var t=document.querySelectorAll(".image-gallery"),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]));return this},instantiate:function(n){if(n&&"undefined"!==n.tagName)return{els:{rootEl:null,colGalleryThumbnails:null,colGalleryMains:null,thumbnailSwiper:{rootEl:null,swiper:null,allSlides:null},mainsSwiper:{rootEl:null,swiper:null,allSlides:null}},listeners:{changeMainImage:[]},filteredSlides:{thumbnails:[],mains:[]},init:function(){var t=this;if(t.els.rootEl=n,t.els.colGalleryThumbnails=n.querySelector(".col-gallery-thumbnails"),t.els.colGalleryMains=n.querySelector(".col-gallery-mains"),t.els.colGalleryThumbnails.length!=t.els.colGalleryMains.length&&console.warn("theme.imageGalleries.instantiate(rootEl) was called, but a different number of thumbnail/mains slides was detected. Unexpected behaviour is likely."),t.initThumbnailSwiper(),t.els.thumbnailSwiper.swiper&&(t.initMainsSwiper(),t.els.mainsSwiper.swiper)){t.els.mainsSwiper.swiper.on("slideChange",function(){t.els.mainsSwiper.swiper.activeIndex<t.els.thumbnailSwiper.swiper.slides.length&&t.selectThumbnailSlideAtIndex(t.els.mainsSwiper.swiper.activeIndex);for(var e=0;e<t.listeners.changeMainImage.length;++e)t.listeners.changeMainImage[e]({galleryInstance:t})});for(var e=0;e<t.els.thumbnailSwiper.allSlides.length;++e)t.els.thumbnailSwiper.allSlides[e].addEventListener("click",function(e){e=[].indexOf.call(t.els.thumbnailSwiper.swiper.slides,e.currentTarget);t.selectThumbnailSlideAtIndex(e),t.selectMainSlideAtIndex(e,1)});return t.selectThumbnailSlideAtIndex(0),t}},initThumbnailSwiper:function(){var e,t,s=this;s.els.thumbnailSwiper.rootEl=s.els.colGalleryThumbnails.querySelector(".gallery-thumbnails.swiper"),s.els.thumbnailSwiper.rootEl?(e=".image-gallery .col-gallery-thumbnails ."+theme.imageGalleries.settings.navigationNextClassName,t=".image-gallery .col-gallery-thumbnails ."+theme.imageGalleries.settings.navigationPrevClassName,s.els.thumbnailSwiper.swiper=new Swiper(s.els.thumbnailSwiper.rootEl,{loop:!1,freeMode:{enabled:!0,sticky:!1},direction:theme.utilities.hasClass(n,"gallery-thumbnails-vertical")?"vertical":"horizontal",slidesPerView:"undefined"!==n.dataset.slidesPerView?n.dataset.slidesPerView:4,slidesPerGroup:"undefined"!==n.dataset.slidesPerGroup?n.dataset.slidesPerGroup:1,spaceBetween:4,navigation:{nextEl:e,prevEl:t}}),this.els.thumbnailSwiper.allSlides=this.els.thumbnailSwiper.rootEl.querySelectorAll(".swiper-slide")):console.warn("theme.imageGalleries.instantiate(rootEl) was called, but no gallery thumbnails swiper markup was found.")},initMainsSwiper:function(){var e,t,s=this;s.els.mainsSwiper.rootEl=s.els.colGalleryMains.querySelector(".gallery-mains.swiper"),s.els.thumbnailSwiper.rootEl?(e=".image-gallery .col-gallery-mains ."+theme.imageGalleries.settings.navigationNextClassName,t=".image-gallery .col-gallery-mains ."+theme.imageGalleries.settings.navigationPrevClassName,s.els.mainsSwiper.swiper=new Swiper(s.els.mainsSwiper.rootEl,{loop:!1,direction:"horizontal",slidesPerView:1,slidesPerGroup:1,spaceBetween:10,threshold:8,navigation:{nextEl:e,prevEl:t}}),s.els.mainsSwiper.allSlides=s.els.mainsSwiper.rootEl.querySelectorAll(".swiper-slide")):console.warn("theme.imageGalleries.instantiate(rootEl) was called, but no gallery mains swiper markup was found.")},deselectThumbnail:function(){for(var e=0;e<this.els.thumbnailSwiper.allSlides.length;++e)this.els.thumbnailSwiper.allSlides[e].classList.remove("gallery-thumbnail-slide-active")},selectThumbnailSlideAtIndex:function(e,t){void 0===e||e<0||e>this.els.thumbnailSwiper.swiper.slides.length-1?console.warn("theme.imageGalleries.instances[#].selectThumbnailSlideAtIndex(index) was called, but an invalid or out of range index ("+e+") was specififed."):(this.deselectThumbnail(),this.els.thumbnailSwiper.swiper.slides[e].classList.add("gallery-thumbnail-slide-active"),this.els.thumbnailSwiper.swiper.activeIndex!=e&&this.els.thumbnailSwiper.swiper.slideTo(e,t))},selectMainSlideAtIndex:function(e,t){void 0===e||e<0||e>this.els.mainsSwiper.swiper.slides.length-1?console.warn("theme.imageGalleries.instances[#].selectMainSlideAtIndex(index) was called, but an invalid or out of range index was specififed."):this.els.mainsSwiper.swiper.activeIndex!=e&&this.els.mainsSwiper.swiper.slideTo(e,t)},filterImagesByProdId:function(e){for(var t=this,s=(e=e?e.toString():"",t.els.thumbnailSwiper.swiper.removeAllSlides(),t.els.mainsSwiper.swiper.removeAllSlides(),[]),n=0;n<t.els.thumbnailSwiper.allSlides.length;++n)void 0!==t.els.thumbnailSwiper.allSlides[n].dataset.multiProdId&&""!=t.els.thumbnailSwiper.allSlides[n].dataset.multiProdId&&"0"!=t.els.thumbnailSwiper.allSlides[n].dataset.multiProdId&&-1===t.els.thumbnailSwiper.allSlides[n].dataset.multiProdId.replace(" ","").split(",").indexOf(e)||s.push(t.els.thumbnailSwiper.allSlides[n]);s.length<=0&&(s=t.els.thumbnailSwiper.allSlides);for(var i=[],n=0;n<t.els.mainsSwiper.allSlides.length;++n)void 0!==t.els.mainsSwiper.allSlides[n].dataset.multiProdId&&""!=t.els.mainsSwiper.allSlides[n].dataset.multiProdId&&"0"!=t.els.mainsSwiper.allSlides[n].dataset.multiProdId&&t.els.mainsSwiper.allSlides[n].dataset.multiProdId!=e||i.push(t.els.mainsSwiper.allSlides[n]);i.length<=0&&(i=t.els.mainsSwiper.allSlides);for(n=0;n<s.length;++n)this.els.thumbnailSwiper.swiper.appendSlide(s[n]),this.els.thumbnailSwiper.swiper.update();for(n=0;n<i.length;++n)this.els.mainsSwiper.swiper.appendSlide(i[n]),this.els.mainsSwiper.swiper.update();this.els.thumbnailSwiper.swiper.update(),this.els.mainsSwiper.swiper.update(),this.selectThumbnailSlideAtIndex(0,1),this.selectMainSlideAtIndex(0,1),this.els.mainsSwiper.swiper.emit("slideChange")},hasAssignedImagesToMultiItems:function(){for(var e=0;e<this.els.thumbnailSwiper.allSlides.length;++e)if(void 0!==this.els.thumbnailSwiper.allSlides[e].dataset.multiProdId&&""!=this.els.thumbnailSwiper.allSlides[e].dataset.multiProdId)return!0;return!1},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.imageGalleries.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.imageGalleries.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init();console.warn("theme.imageGalleries.instantiate(rootEl) was called, but no rootEl (root element) was given.")}},imageEnlarger:{els:{showPopupTriggers:[],popupRoot:null,prevTriggers:[],nextTriggers:[],img:null},init:function(){var t=this;if(t.els.showPopupTriggers=document.querySelectorAll("[data-on-click-enlarge-image]"),t.els.popupRoot=document.querySelector('[data-image-enlarge-popup="1"]'),t.els.prevTriggers=t.els.popupRoot.querySelectorAll("[data-on-click-prev]"),t.els.nextTriggers=t.els.popupRoot.querySelectorAll("[data-on-click-next]"),t.els.img=t.els.popupRoot.querySelector("img"),!t.els.popupRoot||!t.els.img)return this;if(0<theme.imageGalleries.instances.length&&t.handleOnChangeGallery(theme.imageGalleries.instances[0]),0<theme.imageGalleries.instances.length&&theme.imageGalleries.instances[0].on("changeMainImage",function(e){t.handleOnChangeGallery(e.galleryInstance)}),0<theme.imageGalleries.instances.length)for(var e=0;e<t.els.prevTriggers.length;++e)t.els.prevTriggers[e].addEventListener("click",function(){0==theme.imageGalleries.instances[0].els.mainsSwiper.swiper.activeIndex?theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slideTo(theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slides.length-1):theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slidePrev()});if(0<theme.imageGalleries.instances.length)for(e=0;e<t.els.nextTriggers.length;++e)t.els.nextTriggers[e].addEventListener("click",function(){theme.imageGalleries.instances[0].els.mainsSwiper.swiper.activeIndex==theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slides.length-1?theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slideTo(0):theme.imageGalleries.instances[0].els.mainsSwiper.swiper.slideNext()});for(e=0;e<t.els.showPopupTriggers.length;++e)t.els.showPopupTriggers[e].addEventListener("click",function(){t.show()})},handleOnChangeGallery:function(e){var t;e?(e=e.els.mainsSwiper.swiper.slides[e.els.mainsSwiper.swiper.activeIndex])&&((t=e.dataset.fullImgUrl)||e.querySelector("img").src,t)&&(this.els.img.src=t):console.warn("theme.imageEnlarger(galleryInstance) was called, but no gallery instance was given.")},show:function(){theme.genericContentPopup.getInstanceByRootEl(this.els.popupRoot).show()}},orderForms:{settings:{addToBasketText:"Add to Basket",outOfStockText:"Sold Out",preOrderText:"Pre-Order until [stock_date]",backInStockText:"Back in stock [stock_date]",productCodePrefix:"",timestampNow:0,initialProdId:0,selectorPreselectionEnabled:!1},instances:[],init:function(e){e&&(this.settings=theme.utilities.extend(this.settings,e));for(var t=document.querySelectorAll('form[name="orderproduct"]'),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]));return this},instantiate:function(n){if(n&&"FORM"==n.tagName)return{els:{formEl:null,prodIdEls:null,optionEls:null,userTextEl:null,qtyEl:null,declarationRadioEls:null,declarationCheckboxEls:null,submitButton:null,selectors:null,badges:{inStock:null,oos:null,new:null,sale:null,preOrder:null},productCodeWrap:null,productCode:null,pricing:{priceRangeIndicator:null,rrpWrap:null,rrp:null,price:null,priceIncVat:null}},settings:{addToBasketText:"",outOfStockText:"",preOrderText:"",backInStockText:""},listeners:{changeProdId:[],changeAnyInput:[],beforeAddToBasket:[],submit:[]},thisOrderFormInstance:null,subItemsToAdd:[],extraData:{},init:function(){var e=this;if(thisOrderFormInstance=this,e.els.formEl=n,e.initFindEls(),e.initSettings(),!e.hasProdId())return console.warn("theme.orderForms.instantiate(formEl) was called, but formEl contains no prod_el input."),this;e.initSelectors(),e.initEvents();var t=0;return(t=(t=!(t=!(t=window.theme.orderForms.settings.initialProdId&&-1!==e.getAllProdIds(!0).indexOf(window.theme.orderForms.settings.initialProdId)?window.theme.orderForms.settings.initialProdId:t)&&theme.orderForms.settings.selectorPreselectionEnabled?e.getFirstEnabledProdId():t)&&e.selectors&&1==e.selectors.getAllProdIds().length?e.getFirstEnabledProdId():t)||e.selectors||1!=e.getAllProdIds(!0).length?t:e.getFirstEnabledProdId())&&t!=e.getSelectedProdId()&&e.setSelectedProdId(t),e.onChangeAnyInput(),e},initFindEls:function(){var e=this,t=e.els.formEl;e.els.prodIdEls=t.querySelectorAll("[name=prod_id]"),e.els.optionEls=t.querySelectorAll("[data-shop-option-id]"),e.els.userTextEl=t.querySelector('[name="user_text"]'),e.els.qtyEl=t.querySelector('[name="order_qty"]'),e.els.submitButton=t.querySelector("button"),e.els.badges.inStock=t.querySelector(".badge-in-stock"),e.els.badges.new=t.querySelector(".badge-new"),e.els.badges.sale=t.querySelector(".badge-sale"),e.els.badges.oos=t.querySelector(".badge-oos"),e.els.badges.preOrder=t.querySelector(".badge-pre-order"),e.els.productCode=t.querySelector("[data-selected-product-code]"),e.els.pricing.priceRangeIndicators=t.querySelectorAll("[data-selected-price-range-indicator]"),e.els.pricing.rrpWrap=t.querySelector("[data-rrp-wrap]"),e.els.pricing.rrp=t.querySelector("[data-selected-rrp]"),e.els.pricing.price=t.querySelector("[data-selected-price]"),e.els.pricing.priceIncVat=t.querySelector("[data-selected-price-inc-vat]"),e.els.declarationRadioEls=t.querySelectorAll('input[type="radio"][name^="declaration"]'),e.els.declarationCheckboxEls=t.querySelectorAll('input[type="checkbox"][name^="declaration"]')},initSettings:function(){var e=this;e.els.formEl.dataset.addToBasketText&&0<e.els.formEl.dataset.addToBasketText.length&&(e.settings.addToBasketText=e.els.formEl.dataset.addToBasketText),e.els.formEl.dataset.outOfStockText&&0<e.els.formEl.dataset.outOfStockText.length&&(e.settings.outOfStockText=e.els.formEl.dataset.outOfStockText),e.els.formEl.dataset.preOrderText&&0<e.els.formEl.dataset.preOrderText.length&&(e.settings.preOrderText=e.els.formEl.dataset.preOrderText),e.els.formEl.dataset.backInStockText&&0<e.els.formEl.dataset.backInStockText.length&&(e.settings.backInStockText=e.els.formEl.dataset.backInStockText)},initEvents:function(){var s=this;s.selectors&&s.selectors.on("processSelectors",function(e){theme.selectors.settings.highlightMatchedProducts&&s.highlightMatchedProducts(e.prodIds),!e.prodIds||e.prodIds.length<=0?console.warn("selectors completed but returned no products. This should not be possible."):e.isComplete?s.setSelectedProdId(e.prodIds[0]):s.setSelectedProdId(null)}),s.on("changeProdId",function(e){if(s.selectors&&e.prodId&&(s.selectors.selectAllByProdId(e.prodId),theme.selectors.settings.highlightMatchedProductsOnSelectProduct?s.highlightMatchedProducts(s.selectors.getProdIdsFromCurrentSelection()):s.highlightMatchedProducts(s.selectors.getAllProdIds())),s.els.badges.inStock&&s.els.badges.inStock.classList.add("force-hide"),s.els.badges.oos&&s.els.badges.oos.classList.add("force-hide"),s.els.badges.new&&s.els.badges.new.classList.add("force-hide"),s.els.badges.sale&&s.els.badges.sale.classList.add("force-hide"),s.els.badges.preOrder&&s.els.badges.preOrder.classList.add("force-hide"),e.prodId&&(s.updatePricing(),s.els.productCode)&&(s.els.productCode.innerHTML=theme.orderForms.settings.productCodePrefix+e.productData.productCode,s.els.productCode.classList.remove("hide")),e.productData&&void 0!==e.productData.outOfStock){if(s.els.pricing.priceRangeIndicators)for(t=0;t<s.els.pricing.priceRangeIndicators.length;++t)s.els.pricing.priceRangeIndicators[t].classList.add("hide");s.els.productCode&&(s.els.productCode.innerHTML=theme.orderForms.settings.productCodePrefix+e.productData.productCode,s.els.productCode.classList.remove("hide")),void 0===e.prodId?(s.els.badges.oos&&s.els.badges.oos.classList.remove("force-hide"),s.els.productCode&&s.els.productCode.classList.add("hide"),e.instance.disableSubmit(),e.instance.els.submitButton.innerHTML=theme.orderForms.settings.outOfStockText):!e.productData.outOfStock&&e.productData.stockDate&&e.productData.stockDate>theme.orderForms.settings.timestampNow||e.productData.outOfStock&&e.productData.stockDate&&e.productData.stockDate>theme.orderForms.settings.timestampNow&&e.productData.allowOverselling?(s.els.badges.preOrder&&s.els.badges.preOrder.classList.remove("force-hide"),s.els.productCode&&s.els.productCode.classList.add("hide")):!e.productData.outOfStock||e.productData.outOfStock&&e.productData.allowOverselling?(s.els.badges.inStock&&s.els.badges.inStock.classList.remove("force-hide"),s.els.productCode&&(s.els.productCode.innerHTML=theme.orderForms.settings.productCodePrefix+e.productData.productCode,s.els.productCode.classList.remove("hide"))):e.productData.outOfStock&&(s.els.badges.oos&&s.els.badges.oos.classList.remove("force-hide"),s.els.productCode)&&(s.els.productCode.innerHTML=theme.orderForms.settings.productCodePrefix+e.productData.productCode,s.els.productCode.classList.remove("hide"))}else{if(s.els.pricing.priceRangeIndicators)for(var t=0;t<s.els.pricing.priceRangeIndicators.length;++t)s.els.pricing.priceRangeIndicators[t].classList.remove("hide");s.els.productCode&&s.els.productCode.classList.add("hide")}}),s.on("changeAnyInput",function(e){e.prodId&&s.updatePricing(),!e.isSelectionComplete||e.productData&&e.productData.outOfStock&&!e.productData.allowOverselling?s.disableSubmit():s.enableSubmit(),e.productData&&!e.productData.outOfStock&&0<theme.orderForms.settings.timestampNow&&theme.orderForms.settings.timestampNow<e.productData.stockDate||e.productData&&e.productData.outOfStock&&e.productData.allowOverselling&&0<theme.orderForms.settings.timestampNow&&theme.orderForms.settings.timestampNow<e.productData.stockDate?s.settings.preOrderText?s.els.submitButton.innerHTML=s.settings.preOrderText.replace("[stock_date]",e.productData.stockDateAsString):s.els.submitButton.innerHTML=theme.orderForms.settings.preOrderText.replace("[stock_date]",e.productData.stockDateAsString):e.productData&&e.productData.outOfStock&&0<theme.orderForms.settings.timestampNow&&theme.orderForms.settings.timestampNow<e.productData.stockDate?s.settings.backInStockText?s.els.submitButton.innerHTML=s.settings.backInStockText.replace("[stock_date]",e.productData.stockDateAsString):s.els.submitButton.innerHTML=theme.orderForms.settings.backInStockText.replace("[stock_date]",e.productData.stockDateAsString):e.productData&&e.productData.outOfStock&&!e.productData.allowOverselling?s.settings.outOfStockText?s.els.submitButton.innerHTML=s.settings.outOfStockText:s.els.submitButton.innerHTML=theme.orderForms.settings.outOfStockText:(e.productData&&e.productData.outOfStock&&e.productData.allowOverselling,s.settings.addToBasketText?s.els.submitButton.innerHTML=s.settings.addToBasketText:s.els.submitButton.innerHTML=theme.orderForms.settings.addToBasketText)}),s.on("submit",function(e){theme.basket.add(e.addToBasketData)});for(var e=0;e<s.els.prodIdEls.length;++e)s.els.prodIdEls[e].addEventListener("change",function(e){s.onChangeProdId(),s.onChangeAnyInput()});for(e=0;e<s.els.optionEls.length;++e)s.els.optionEls[e].addEventListener("change",function(e){s.onChangeAnyInput()});if(s.els.qtyEl&&s.els.qtyEl.addEventListener("change",function(e){s.onChangeAnyInput()}),s.els.declarationRadioEls)for(e=0;e<s.els.declarationRadioEls.length;++e)s.els.declarationRadioEls[e].addEventListener("change",function(){s.onChangeAnyInput()});if(s.els.declarationCheckboxEls)for(e=0;e<s.els.declarationCheckboxEls.length;++e)s.els.declarationCheckboxEls[e].addEventListener("change",function(){s.onChangeAnyInput()});n.addEventListener("submit",function(e){e.stopPropagation(),e.preventDefault(),s.onSubmit()})},updatePricing:function(){var e,t=this;t.getSelectedProdId()&&!isNaN(parseInt(t.getSelectedProdId()))&&(e=t.getTotals(),t.els.pricing.price&&(t.els.pricing.price.innerHTML=e.price),t.els.pricing.priceIncVat&&(t.els.pricing.priceIncVat.innerHTML=parseFloat(parseFloat(e.price)+parseFloat(e.vat)).toFixed(2)),t.els.pricing.rrp)&&e.rrp&&(t.els.pricing.rrp.innerHTML=e.rrp,parseFloat(e.rrp)<=parseFloat(e.price)?(t.els.pricing.rrpWrap||t.els.pricing.rrp).classList.add("hide"):(t.els.pricing.rrpWrap||t.els.pricing.rrp).classList.remove("hide"))},addExtraData:function(e,t){e||console.warn("Called setExtraData() but no key was provided."),this.extraData[e]=t},removeExtraDataByKey:function(e){e||console.warn("Called removeExtraData() but no key was provided."),delete extraData[e]},clearExtraData:function(){for(var e=Object.keys(this.extraData),t=0;t<e.length;++t)delete this.extraData[e[t]]},getExtraData:function(){return this.extraData||{}},initSelectors:function(){this.selectors=theme.selectors.instantiate({orderFormInstance:thisOrderFormInstance})},getAllProdIds:function(e){for(var t=this,s=[],n=0;n<t.els.prodIdEls.length;++n)if("SELECT"==t.els.prodIdEls[n].tagName)for(var i=0;i<this.els.prodIdEls[n].options.length;++i)!t.els.prodIdEls[n].options[i].value||e&&t.els.prodIdEls[n].options[i].disabled||s.push(t.els.prodIdEls[n].options[i].value);else"INPUT"==t.els.prodIdEls[n].tagName&&"hidden"==t.els.prodIdEls[n].type?!t.els.prodIdEls[n].value||e&&t.els.prodIdEls[n].disabled||s.push(t.els.prodIdEls[n].value):"INPUT"!=t.els.prodIdEls[n].tagName||"radio"!=t.els.prodIdEls[n].type||!t.els.prodIdEls[n].value||e&&t.els.prodIdEls[n].disabled||s.push(t.els.prodIdEls[n].value);return s},getVoucherAddToBasketData:function(){var e,t,s,n,i,l,o;return"voucher"!=this.els.formEl.dataset.specialFormType?(console.warn('Called getVoucherAddToBasketData() but this order form is not of special type "voucher"'),{}):(e=this.els.formEl.querySelector('input[name="to_name"]'),t=this.els.formEl.querySelector('input[name="from_name"]'),s=this.els.formEl.querySelector('input[name="value"]'),n=this.els.formEl.querySelector('textarea[name="to_message"]'),i=this.els.formEl.querySelector('input[name="to_email_address"]'),l=this.els.formEl.querySelector('input[name="gift_voucher_method"]:checked'),o=this.els.formEl.querySelector('input[name="send_to_recipient"]:checked'),{to_name:e.value,from_name:t.value,product_price:s.value,to_message:n.value,to_email_address:i.value,send_printed_voucher:l.value,send_to_recipient:o.value})},getAddToBasketData:function(){var e,t={prod_id:this.getSelectedProdId(),order_qty:Math.max(1,parseInt(this.els.qtyEl.value)),user_text:"",options:[],sub_items:this.subItemsToAdd&&0<this.subItemsToAdd.length?this.subItemsToAdd:[],extra_data:this.getExtraData()};this.els.userTextEl&&(t.user_text=this.els.userTextEl.value);if(0<this.els.optionEls.length)for(var s=0;s<this.els.optionEls.length;++s)e=this.els.optionEls[s].options[this.els.optionEls[s].selectedIndex],t.options.push({shop_option_id:this.els.optionEls[s].dataset.shopOptionId,shop_option_value_id:e.dataset.shopOptionValueId});"voucher"==this.els.formEl.dataset.specialFormType&&(t.voucher_details=this.getVoucherAddToBasketData());for(s=0;s<t.sub_items.length;++s)t.sub_items[s].order_qty=t.order_qty;var n=[];return n.push(t),{items:n}},getSelectedProdId:function(){var e=this;if("select"==e.getProdIdType()||"hidden"==e.getProdIdType())return e.els.prodIdEls[0].value;if("radio"==e.getProdIdType()){for(var t=0;t<e.els.prodIdEls.length;++t)if(e.els.prodIdEls[t].checked)return e.els.prodIdEls[t].value;return null}},setSelectedProdId:function(e){"boolean"!=typeof notifyListeners&&(notifyListeners=!0);var t=this;if(e&&!isNaN(e)||(e=null),t.hasProdId()){if("select"==t.getProdIdType()||"hidden"==t.getProdIdType())t.els.prodIdEls[0].value=e;else if("radio"==t.getProdIdType())for(var s=0;s<t.els.prodIdEls.length;++s)t.els.prodIdEls[s].value==e?t.els.prodIdEls[s].checked=!0:t.els.prodIdEls[s].checked=!1;t.onChangeProdId(),t.onChangeAnyInput()}else console.warn("theme.orderForms.instances[#].setSelectedProdId(prodId) was called, but form has no prod ID field.")},getFirstEnabledProdId:function(){var e=this;if(e.hasProdId()){if("select"==e.getProdIdType()){for(var t=0;t<e.els.prodIdEls[0].options.length;++t)if(!e.els.prodIdEls[0].options[t].disabled&&e.els.prodIdEls[0].options[t].value)return e.els.prodIdEls[0].options[t].value;return null}if("hidden"==e.getProdIdType())return e.els.prodIdEls[0].value;if("radio"==e.getProdIdType())for(t=0;t<e.els.prodIdEls.length;++t)if(!e.els.prodIdEls[t].disabled)return e.els.prodIdEls[t].value}else console.warn("theme.orderForms.instances[#].getFirstEnabledProdId(prodId) was called, but form has no prod ID field.")},getProdIdType:function(){if(this.hasProdId())return"SELECT"==this.els.prodIdEls[0].tagName?"select":"INPUT"==this.els.prodIdEls[0].tagName&&"radio"==this.els.prodIdEls[0].type?"radio":"INPUT"==this.els.prodIdEls[0].tagName&&"hidden"==this.els.prodIdEls[0].type?"hidden":void 0;console.warn("theme.orderForms.instances[#].getProdIdType() was called, but form has no prod ID field.")},getTotals:function(){var e={price:0,vat:0,rrp:0};if("select"==this.getProdIdType()){var t=this.els.prodIdEls[0].selectedIndex<=-1?0:this.els.prodIdEls[0].selectedIndex;e.price+=parseFloat(this.els.prodIdEls[0].options[t].dataset.price),e.vat+=parseFloat(this.els.prodIdEls[0].options[t].dataset.vat),this.els.prodIdEls[0].options[t].dataset.rrp&&(e.rrp+=parseFloat(this.els.prodIdEls[0].options[t].dataset.rrp))}else if("radio"==this.getProdIdType())for(var s=0;s<this.els.prodIdEls.length;++s)this.els.prodIdEls[s].checked&&(e.price+=parseFloat(this.els.prodIdEls[s].dataset.price),e.vat+=parseFloat(this.els.prodIdEls[s].dataset.vat),this.els.prodIdEls[s].dataset.rrp)&&(e.rrp+=parseFloat(this.els.prodIdEls[s].dataset.rrp));else"hidden"==this.getProdIdType()&&(e.price+=parseFloat(this.els.prodIdEls[0].dataset.price),e.vat+=parseFloat(this.els.prodIdEls[0].dataset.vat),this.els.prodIdEls[0].dataset.rrp)&&(e.rrp+=parseFloat(this.els.prodIdEls[0].dataset.rrp));for(var n,s=0;s<this.els.optionEls.length;++s)(n=this.els.optionEls[s].options[this.els.optionEls[s].selectedIndex]).dataset.price&&(e.price+=parseFloat(n.dataset.price)),n.dataset.vat&&(e.vat+=parseFloat(n.dataset.vat)),n.dataset.rrp?e.rrp+=parseFloat(n.dataset.rrp):n.dataset.price&&(e.rrp+=parseFloat(n.dataset.price));return e.price=e.price.toFixed(2),e.vat=e.vat.toFixed(2),e.rrp=e.rrp.toFixed(2),e},addSubItem:function(e){var t=theme.utilities.extend({key:"",prod_id:null,order_qty:1,user_text:"",options:[],sub_items:[]},e);!t.prod_id||isNaN(t.prod_id)?console.warn("theme.orderForms.instances[#].addSubItem(args) was called, but an invalid prod_id ("+e.prod_id+") was given."):this.subItemsToAdd.push(t)},removeSubItem:function(e){for(var t=-1,s=0;s<this.subItemsToAdd.length;++s)if(this.subItemsToAdd[s].prod_id==e){t=s;break}t<=-1?console.warn("theme.orderForms.instances[#].removeSubItem(prodId) was called, but no prodId was found for "+e+"."):this.subItemsToAdd.splice(t,1)},removeSubItemsByKey:function(t){var e;t&&(e=this.subItemsToAdd.filter(function(e){return e.key!=t}),this.subItemsToAdd=e)},clearSubItems:function(){this.subItemsToAdd.length=0},enableSubmit:function(){this.els.submitButton.disabled=!1},disableSubmit:function(){this.els.submitButton.disabled=!0},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.orderForms.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.orderForms.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")},onChangeProdId:function(){for(var e=this.getTotals(),t={instance:this,prodId:this.getSelectedProdId(),totalPrice:e.price,totalVat:e.vat,rrp:e.rrp,isSelectionComplete:this.isSelectionComplete(),productData:theme.productData.getProductData(this.getSelectedProdId())},s=0;s<this.listeners.changeProdId.length;++s)this.listeners.changeProdId[s](t)},onChangeAnyInput:function(){for(var e=this.getTotals(),t=theme.productData.getProductData(this.getSelectedProdId()),s=0;s<this.listeners.changeAnyInput.length;++s)this.listeners.changeAnyInput[s]({prodId:this.getSelectedProdId(),totalPrice:e.price,totalVat:e.vat,rrp:e.rrp,isSelectionComplete:this.isSelectionComplete(),productData:t})},onSubmit:function(){if(this.isSelectionComplete()){for(var e=0;e<this.listeners.beforeAddToBasket.length;++e)this.listeners.beforeAddToBasket[e]({addToBasketData:this.getAddToBasketData()});for(e=0;e<this.listeners.submit.length;++e)this.listeners.submit[e]({addToBasketData:this.getAddToBasketData()})}else console.warn("theme.orderForms.instances[#].onSubmit() was called, but form selection is not complete!")},hasProdId:function(){return!!(this.els.prodIdEls&&0<this.els.prodIdEls.length)},isSelectionComplete:function(){var e=this;if(!e.getSelectedProdId())return!1;for(var t,s=0;s<e.els.optionEls.length;++s)if(!(t=e.els.optionEls[s].options[e.els.optionEls[s].selectedIndex])||!t.dataset.shopOptionValueId)return!1;if(e.els.declarationCheckboxEls)for(s=0;s<e.els.declarationCheckboxEls.length;++s)if(!e.els.declarationCheckboxEls[s].checked)return!1;if(e.els.declarationRadioEls){for(var n=[],s=0;s<e.els.declarationRadioEls.length;++s)-1===n.indexOf(e.els.declarationRadioEls[s].name)&&n.push(e.els.declarationRadioEls[s].name);for(s=0;s<n.length;++s){for(var i=!1,l=0;l<e.els.declarationRadioEls.length;++l)e.els.declarationRadioEls[l].name===n[s]&&e.els.declarationRadioEls[l].checked&&(i=!0);if(!i)return!1}}return!0},highlightMatchedProducts:function(e){e=e||[];var t=this,s=t.getProdIdType(),n=[];if("select"==s){for(var i=[],l=[],o=[],r=[],a=0;a<t.els.prodIdEls[0].options.length;++a)if(e.length<=0||e.length==t.selectors.getAllProdIds().length)o.push(t.els.prodIdEls[0].options[a]),t.els.prodIdEls[0].options[a].classList.remove("selectors-not-matched"),t.els.prodIdEls[0].options[a].classList.remove("selectors-match");else if(t.els.prodIdEls[0].options[a].value)for(n=t.els.prodIdEls[0].options[a].value.split(","),oI=0;oI<n.length;++oI)-1!==e.indexOf(n[oI])?(i.push(t.els.prodIdEls[0].options[a]),t.els.prodIdEls[0].options[a].classList.add("selectors-match"),t.els.prodIdEls[0].options[a].classList.remove("selectors-not-matched")):(l.push(t.els.prodIdEls[0].options[a]),t.els.prodIdEls[0].options[a].classList.add("selectors-not-matched"),t.els.prodIdEls[0].options[a].classList.remove("selectors-match"));else r.push(t.els.prodIdEls[0].options[a]);var d,c,u=0;if(0<o.length)for(u=0;u<o.length;++u)theme.utilities.append(o[u],t.els.prodIdEls[0]);if(0<l.length)for((c=t.els.prodIdEls[0].querySelector('optgroup[data-type="unmatched"]'))||((c=document.createElement("optgroup")).dataset.type="unmatched",c.label="Unmatched products",c=theme.utilities.prepend(c,t.els.prodIdEls[0])),u=0;u<l.length;++u)theme.utilities.append(l[u],c);if(0<i.length)for((d=t.els.prodIdEls[0].querySelector('optgroup[data-type="matched"]'))||((d=document.createElement("optgroup")).dataset.type="matched",d.label="Matched products",d=theme.utilities.prepend(d,t.els.prodIdEls[0])),u=0;u<i.length;++u)theme.utilities.append(i[u],d);if(0<r.length)for(u=0;u<r.length;++u)theme.utilities.prepend(r[u],t.els.prodIdEls[0]);i.length<=0&&(d=t.els.prodIdEls[0].querySelector('optgroup[data-type="matched"]'))&&theme.utilities.remove(d),l.length<=0&&(c=t.els.prodIdEls[0].querySelector('optgroup[data-type="unmatched"]'))&&theme.utilities.remove(c)}else if("radio"==s)for(a=0;a<t.els.prodIdEls.length;++a)if(e.length<=0||e.length==t.selectors.getAllProdIds().length)t.els.prodIdEls[a].classList.remove("selectors-not-matched"),t.els.prodIdEls[a].classList.remove("selectors-match");else for(n=t.els.prodIdEls[a].value.split(","),oI=0;oI<n.length;++oI)-1!==e.indexOf(n[oI])?(t.els.prodIdEls[a].classList.add("selectors-match"),t.els.prodIdEls[a].classList.remove("selectors-not-matched")):(t.els.prodIdEls[a].classList.add("selectors-not-matched"),t.els.prodIdEls[a].classList.remove("selectors-match"))}}.init();console.warn("theme.orderForms.instantiate(formEl) was called, but no form element was given.")},getFormsOfType:function(e){"undefined"===e&&(e="");for(var t=[],s=0;s<this.instances.length;++s)(void 0!==this.instances[s].els.formEl.dataset.type?this.instances[s].els.formEl.dataset.type:"")==e&&t.push(this.instances[s]);return t}},selectors:{settings:{showProducts:!1,highlightMatchedProducts:!0,highlightMatchedProductsOnSelectProduct:!0,preventDeselection:!1},instances:[],init:function(e){e&&theme.utilities.extend(theme.selectors.settings,e)},instantiate:function(e){if(e&&e.orderFormInstance)return(e={settings:{orderFormInstance:null},els:{selectorInputs:null,prodIdWrap:null},listeners:{processSelectors:[]},init:function(e){var t=this;return e&&(t.settings=theme.utilities.extend(t.settings,e)),t.initFindEls(),!t.els.selectorInputs||t.els.selectorInputs.length<=0?null:(t.initEvents(),theme.selectors.settings.showProducts?t.showProducts():t.hideProducts(),this)},initFindEls:function(){this.els.selectorInputs=this.settings.orderFormInstance.els.formEl.querySelectorAll('[name^="selector-"]'),this.els.prodIdWrap=this.settings.orderFormInstance.els.formEl.querySelector(".selectors-prod-id")},initEvents:function(){for(var t=this,e=t.getSelectorRadioInputs(),s=0;s<e.length;s++)e[s].addEventListener("click",function(e){e.currentTarget.dataset.checked&&"1"===e.currentTarget.dataset.checked&&!theme.selectors.settings.preventDeselection?(e.currentTarget.checked=!1,t.selectByProdId(e.currentTarget.name,null),t.processSelectors(e.currentTarget)):theme.utilities.hasClass(e.currentTarget,"disabled-visually")&&(t.resetAllSelectors(),t.selectByProdId(e.currentTarget.name,e.currentTarget.value.split(",")[0]),t.processSelectors(e.currentTarget))}),e[s].addEventListener("change",function(e){t.onChangeSelector(e.currentTarget),t.processSelectors(e.currentTarget)});for(var n=t.getSelectorSelectInputs(),s=0;s<n.length;s++)n[s].addEventListener("change",function(e){t.onChangeSelector(e.currentTarget),t.processSelectors(e.currentTarget)})},selectAllByProdId:function(e){for(var t=this.getSelectorNames(),s=0;s<t.length;++s)-1===this.getProdIdsBySelectorName(t[s]).indexOf(e)&&this.selectByProdId(t[s],e);this.processSelectors(null,!1)},selectByProdId:function(e,t){if(e){isNaN(t)&&(t=null);for(var s=this.getSelectorInputsBySelectorName(e),n=0;n<s.length;++n){if("SELECT"==s[n].tagName){for(var i=!1,l=0;l<s[n].options.length;++l)if(-1!==s[n].options[l].value.split(",").indexOf(t||"")){s[n].selectedIndex=l,i=!0;break}i||(s[n].selectedIndex=-1)}else"INPUT"==s[n].tagName&&"radio"==s[n].type&&(-1===s[n].value.split(",").indexOf(t)?s[n].checked=!1:s[n].checked=!0);this.onChangeSelector(s[n])}}else console.warn("getSelectorValue(selectorName) was called, but no selectorName was given")},resetAllSelectors:function(){for(var e=this.getSelectorNames(),t=0;t<e.length;++t)this.selectByProdId(e[t],null)},getSelectorInputsBySelectorName:function(e){if(!e)return console.warn("getSelectorInputsBySelectorName(selectorName) was called, but no selectorName was given"),[];for(var t=[],s=0;s<this.els.selectorInputs.length;++s)this.els.selectorInputs[s].name==e&&t.push(this.els.selectorInputs[s]);return t},getSelectorRadioInputs:function(){for(var e=[],t=0;t<this.els.selectorInputs.length;++t)"INPUT"==this.els.selectorInputs[t].tagName&&"radio"==this.els.selectorInputs[t].type&&e.push(this.els.selectorInputs[t]);return e},getSelectorSelectInputs:function(){for(var e=[],t=0;t<this.els.selectorInputs.length;++t)"SELECT"==this.els.selectorInputs[t].tagName&&e.push(this.els.selectorInputs[t]);return e},getSelectorInputType:function(e){if(e)return"INPUT"==e.tagName&&"radio"==e.type?"radio":"SELECT"==e.tagName?"select":"other"},getAllProdIds:function(){for(var e=this,t=[],s=null,n=0;n<e.els.selectorInputs.length;++n)if("SELECT"==e.els.selectorInputs[n].tagName)for(var i=0;i<this.els.selectorInputs[n].options.length;++i)for(var s=e.els.selectorInputs[n].options[i].value.split(","),l=0;l<s.length;++l)s[l]&&-1===t.indexOf(s[l])&&t.push(s[l]);else if("INPUT"==e.els.selectorInputs[n].tagName&&"hidden"==e.els.selectorInputs[n].type){s=e.els.selectorInputs[n].value.split(",");for(l=0;l<s.length;++l)s[l]&&-1===t.indexOf(s[l])&&t.push(s[l])}else if("INPUT"==e.els.selectorInputs[n].tagName&&"radio"==e.els.selectorInputs[n].type){s=e.els.selectorInputs[n].value.split(",");for(l=0;l<s.length;++l)s[l]&&-1===t.indexOf(s[l])&&t.push(s[l])}return t},getProdIdsBySelectorName:function(e){var t=this;if(e){for(var s=0;s<t.els.selectorInputs.length;++s)if(t.els.selectorInputs[s].name==e){if("SELECT"==t.els.selectorInputs[s].tagName)return""!=t.els.selectorInputs[s].value?t.els.selectorInputs[s].value.split(","):[];if("INPUT"==t.els.selectorInputs[s].tagName&&"hidden"==t.els.selectorInputs[s].type)return t.els.selectorInputs[s].value.split(",");if("INPUT"==t.els.selectorInputs[s].tagName&&"radio"==t.els.selectorInputs[s].type&&t.els.selectorInputs[s].checked)return t.els.selectorInputs[s].value.split(",")}}else console.warn("getSelectorValue(selectorName) was called, but no selectorName was given");return[]},getSelectorNames:function(){for(var e=[],t=0;t<this.els.selectorInputs.length;++t)-1===e.indexOf(this.els.selectorInputs[t].name)&&e.push(this.els.selectorInputs[t].name);return e},getProdIdsFromCurrentSelection:function(e){e=e||"";for(var t,s=[],n=[],i=this.getSelectorNames(),l=0;l<i.length;++l)if((!e||i[l]!=e)&&(n.length=0,t=this.getProdIdsBySelectorName(i[l]))&&!(t.length<=0)){if(s.length<=0)s=t;else for(var o=0;o<t.length;++o)-1!==s.indexOf(t[o])&&n.push(t[o]);if(0<n.length)for(o=s.length=0;o<n.length;++o)s.push(n[o])}return s=!s||s.length<=0?this.getAllProdIds():s},showProducts:function(){this.els.prodIdWrap&&this.els.prodIdWrap.classList.remove("hide")},hideProducts:function(){this.els.prodIdWrap&&this.els.prodIdWrap.classList.add("hide")},onChangeSelector:function(e){if("radio"==this.getSelectorInputType(e))for(var t=this.getSelectorInputsBySelectorName(e.name),s=0;s<t.length;++s)t[s].checked?t[s].dataset.checked=1:delete t[s].dataset.checked},processSelectors:function(e,t){excludeSelectorName=e?e.name:"","boolean"!=typeof t&&(t=!0);var s=this,n=(s.doEnableDisableSelectors(),e&&0<s.getProdIdsBySelectorName(e.name).length&&s.doSelectSingleOptionSelectors(excludeSelectorName),{prodIds:s.getProdIdsFromCurrentSelection(),isComplete:s.isSelectorsCompleted(),selectorInstance:s});if(theme.selectors.settings.showProducts||(n.isComplete&&1!=n.prodIds.length?s.showProducts():n.isComplete||s.hideProducts()),t)for(var i=0;i<s.listeners.processSelectors.length;++i)s.listeners.processSelectors[i](n)},doEnableDisableSelectors:function(e){e=e||"";for(var t,s=this.getSelectorNames(),n=null,i=null,l=0;l<s.length;++l)if(s[l]!=e)if(n=this.getProdIdsFromCurrentSelection(s[l]),i=this.getSelectorInputsBySelectorName(s[l]),"radio"==(t=this.getSelectorInputType(i[0])))for(var o=0;o<i.length;++o){i[o].classList.add("disabled-visually"),thisProdIds=i[o].value.split(",");for(var r=0;r<thisProdIds.length;++r)if(-1!==n.indexOf(thisProdIds[r])){i[o].classList.remove("disabled-visually");break}}else if("select"==t)for(var a=0;a<i[0].options.length;++a){i[0].options[a].value&&(i[0].options[a].disabled=!0),thisProdIds=i[0].options[a].value.split(",");for(r=0;r<thisProdIds.length;++r)if(-1!==n.indexOf(thisProdIds[r])){i[0].options[a].disabled=!1;break}}},doSelectSingleOptionSelectors:function(e){e=e||"";for(var t=this.getSelectorNames(),s=[],n=0;n<t.length;++n)if(t[n]!=e&&!(0<this.getProdIdsBySelectorName(t[n]).length)){if(inputs=this.getSelectorInputsBySelectorName(t[n]),selectorType=this.getSelectorInputType(inputs[0]),s.length=0,"radio"==selectorType)for(inpI=0;inpI<inputs.length;++inpI)theme.utilities.hasClass(inputs[inpI],"disabled-visually")||inputs[inpI].disabled||s.push(inputs[inpI]);else if("select"==selectorType)for(opI=0;opI<inputs[0].options.length;++opI)inputs[0].options[opI].disabled||s.push(inputs[0].options[opI]);1==s.length&&this.selectByProdId(t[n],s[0].value.split(",")[0])}},isSelectorsCompleted:function(){for(var e=this.getSelectorNames(),t=0;t<e.length;++t)if(this.getProdIdsBySelectorName(e[t]).length<=0)return!1;return!0},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.orderForms.instances[#].selectors.on(eventName, callback) was called, but no callback function was given."):console.warn("theme.orderForms.instances[#].selectors.on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init(e))&&this.instances.push(e),e}},bundleForms:{settings:{addToBasketText:"Add to Basket",outOfStockText:"Sold Out",preOrderText:"Pre-Order until [stock_date]",backInStockText:"Back in stock [stock_date]"},instances:[],init:function(e){e&&(this.settings=theme.utilities.extend(this.settings,e));for(var t=document.querySelectorAll('form[name="orderbundle"]'),s=0;s<t.length;++s)this.instances.push(this.instantiate(t[s]));return this},instantiate:function(s){if(s&&"FORM"==s.tagName)return{els:{formEl:null,mainBundleProdIdEl:null,bundleSetSelects:null,bundleSetMemberOptionWraps:null,bundleSetMemberOptionSelects:null,bundleMainOptionSelects:null,userTextEl:null,qtyEl:null,submitButton:null},listeners:{changeAnySelect:[],submit:[]},init:function(){var t=this;t.els.formEl=s,t.els.mainBundleProdIdEl=t.els.formEl.querySelector("input[name=prod_id]"),t.els.bundleSetSelects=t.els.formEl.querySelectorAll("select[name^=bundleset][data-bundle-set-id]"),t.els.bundleSetMemberOptionWraps=t.els.formEl.querySelectorAll(".bundle-set-options"),t.els.bundleSetMemberOptionSelects=t.els.formEl.querySelectorAll(".bundle-set-options select"),t.els.bundleMainOptionSelects=t.els.formEl.querySelectorAll("select[name^=option]"),t.els.userTextEl=t.els.formEl.querySelector("input[name=user_text]"),t.els.qtyEl=t.els.formEl.querySelector("input[name=order_qty]"),t.els.submitButton=t.els.formEl.querySelector("button"),t.on("submit",function(e){theme.basket.add(e.addToBasketData)}),s.addEventListener("submit",function(e){e.stopPropagation(),e.preventDefault(),t.onSubmit()});for(var e=0;e<t.els.bundleSetSelects.length;++e)t.els.bundleSetSelects[e].addEventListener("change",function(){t.onChangeAnySelect()});for(e=0;e<t.els.bundleSetMemberOptionSelects.length;++e)t.els.bundleSetMemberOptionSelects[e].addEventListener("change",function(){t.onChangeAnySelect()});for(e=0;e<t.els.bundleMainOptionSelects.length;++e)t.els.bundleMainOptionSelects[e].addEventListener("change",function(){t.onChangeAnySelect()});return this.onChangeAnySelect(),this},getBundlesetOptionWrapsByBundleSetId:function(e){for(var t=[],s=0;s<this.els.bundleSetMemberOptionWraps.length;++s)this.els.bundleSetMemberOptionWraps[s].dataset.bundleSetId==e&&t.push(this.els.bundleSetMemberOptionWraps[s]);return t},getBundlesetOptionWrapByBundleSetIdAndBundleMemberId:function(e,t){for(var s=0;s<this.els.bundleSetMemberOptionWraps.length;++s)if(this.els.bundleSetMemberOptionWraps[s].dataset.bundleSetId==e&&this.els.bundleSetMemberOptionWraps[s].dataset.bundleMemberId==t)return this.els.bundleSetMemberOptionWraps[s];return null},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.bundleForms.on(eventName, callback) was called, but no callback function was given."):console.warn("theme.bundleForms.on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")},getAddToBasketData:function(){var e={prod_id:this.els.mainBundleProdIdEl.value,order_qty:Math.max(1,parseInt(this.els.qtyEl.value)),user_text:"",options:[],sub_items:[]},t=(this.els.userTextEl&&(e.user_text=this.els.userTextEl.value),null);if(0<this.els.bundleMainOptionSelects.length)for(var s=0;s<this.els.bundleMainOptionSelects.length;++s)t=this.els.bundleMainOptionSelects[s].options[this.els.bundleMainOptionSelects[s].selectedIndex],e.options.push({shop_option_id:this.els.bundleMainOptionSelects[s].dataset.shopOptionId,shop_option_value_id:t.dataset.shopOptionValueId});for(var n=null,i=null,s=0;s<this.els.bundleSetSelects.length;++s)if(this.els.bundleSetSelects[s].value){if(n={prod_id:this.els.bundleSetSelects[s].value,order_qty:e.order_qty,user_text:"",options:[]},i=this.getBundlesetOptionWrapByBundleSetIdAndBundleMemberId(this.els.bundleSetSelects[s].dataset.bundleSetId,this.els.bundleSetSelects[s].value))for(var l=i.querySelectorAll("select"),o=0;o<l.length;++o)t=l[o].options[l[o].selectedIndex],n.options.push({shop_option_id:l[o].dataset.shopOptionId,shop_option_value_id:t.dataset.shopOptionValueId});e.sub_items.push(n)}var r=[];return r.push(e),{items:r}},getSelectionImages:function(){for(var e,t=[],s=0;s<this.els.bundleSetSelects.length;++s)(e=this.els.bundleSetSelects[s]).options[e.selectedIndex].dataset.thumbImgUrl&&t.push({thumbImgUrl:e.options[e.selectedIndex].dataset.thumbImgUrl,thumbImgWidth:e.options[e.selectedIndex].dataset.thumbImgWidth||0,thumbImgHeight:e.options[e.selectedIndex].dataset.thumbImgHeight||0});return t},getTotals:function(){for(var e,t,s,n={price:parseFloat(this.els.mainBundleProdIdEl.dataset.price),vat:parseFloat(this.els.mainBundleProdIdEl.dataset.vat)},i=null,l=0;l<this.els.bundleSetSelects.length;++l)if(e=this.els.bundleSetSelects[l].dataset.bundleSetId,t=this.els.bundleSetSelects[l].value,n.price=n.price+parseFloat(this.els.bundleSetSelects[l].options[this.els.bundleSetSelects[l].selectedIndex].dataset.price),n.vat=n.vat+parseFloat(this.els.bundleSetSelects[l].options[this.els.bundleSetSelects[l].selectedIndex].dataset.vat),i=this.getBundlesetOptionWrapByBundleSetIdAndBundleMemberId(e,t))for(s=i.querySelectorAll("select"),selI=0;selI<s.length;++selI)n.price=n.price+parseFloat(s[selI].options[s[selI].selectedIndex].dataset.price),n.vat=n.vat+parseFloat(s[selI].options[s[selI].selectedIndex].dataset.vat);for(l=0;l<this.els.bundleMainOptionSelects.length;++l)n.price=n.price+parseFloat(this.els.bundleMainOptionSelects[l].options[this.els.bundleMainOptionSelects[l].selectedIndex].dataset.price),n.vat=n.vat+parseFloat(this.els.bundleMainOptionSelects[l].options[this.els.bundleMainOptionSelects[l].selectedIndex].dataset.vat);return n.price=n.price.toFixed(2),n.vat=n.vat.toFixed(2),n},enableSubmit:function(){this.els.submitButton.disabled=!1},disableSubmit:function(){this.els.submitButton.disabled=!0},updateBundleOptions:function(){for(var e=null,t=null,s=0;s<this.els.bundleSetSelects.length;++s)for(var n=this.els.bundleSetSelects[s].dataset.bundleSetId,i=this.els.bundleSetSelects[s].value,e=this.getBundlesetOptionWrapsByBundleSetId(n),l=0;l<e.length;++l)if(e[l].dataset.bundleMemberId==i){for(var t=e[l].querySelectorAll("select"),o=0;o<t.length;++o)t[o].required=!0;e[l].classList.remove("hide")}else{t=e[l].querySelectorAll("select");for(o=0;o<t.length;++o)t[o].selectedIndex=0,t[o].required=!1;e[l].classList.add("hide")}},onChangeAnySelect:function(){for(var e=this,t=theme.productData.getProductData(e.els.mainBundleProdIdEl.value),s=(this.updateBundleOptions(),!this.isSelectionComplete()||t&&t.outOfStock?(this.disableSubmit(),t&&t.outOfStock?e.els.submitButton.innerHTML=theme.bundleForms.settings.outOfStockText:e.els.submitButton.innerHTML=theme.bundleForms.settings.addToBasketText):(this.enableSubmit(),e.els.submitButton.innerHTML=theme.bundleForms.settings.addToBasketText),this.getTotals()),n=0;n<this.listeners.changeAnySelect.length;++n)this.listeners.changeAnySelect[n]({instance:e,totalPrice:s.price,totalVat:s.vat,isSelectionComplete:this.isSelectionComplete(),selectionImages:this.getSelectionImages(),productData:t})},onSubmit:function(){if(this.isSelectionComplete())for(var e=0;e<this.listeners.submit.length;++e)this.listeners.submit[e]({addToBasketData:this.getAddToBasketData()});else console.warn("theme.bundleForms.instances[#].onSubmit() was called, but form selection is not complete!")},isSelectionComplete:function(){for(var e,t=null,s=0;s<this.els.bundleSetSelects.length;++s){if((e=this.els.bundleSetSelects[s]).required&&!e.value)return!1;if(t=this.getBundlesetOptionWrapByBundleSetIdAndBundleMemberId(e.dataset.bundleSetId,e.value))for(var n=t.querySelectorAll("select"),i=0;i<n.length;++i)if(!n[i].value)return!1}for(s=0;s<this.els.bundleMainOptionSelects.length;++s)if(!this.els.bundleMainOptionSelects[s].value)return!1;return!0}}.init();console.warn("theme.bundleForms.instantiate(formEl) was called, but no form element was given.")},getFormsOfType:function(e){"undefined"===e&&(e="");for(var t=[],s=0;s<this.instances.length;++s)(void 0!==this.instances[s].els.formEl.dataset.type?this.instances[s].els.formEl.dataset.type:"")==e&&t.push(this.instances[s]);return t}},basket:{settings:{currencyCode:"GBP"},listeners:{updateBasket:[],addToBasketError:[]},init:function(e){return this.settings=theme.utilities.extend(this.settings,e),this},add:function(e,n,i){var t;e?((e=theme.utilities.extend({items:[]},e)).get_images=!0,theme.loading.show(),t="/ajax/?action=add-to-basket&currency_code="+this.settings.currencyCode,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(s){setTimeout(function(){if(theme.loading.hide(),!0===s.success){"function"==typeof n&&n({checkoutUrl:s.checkout_url,minibasket:s.minibasket});var e=s.just_added_item||null;e.children=[];for(var t=0;t<s.minibasket.items.length;++t)s.minibasket.items[t].element_id!=e.element_id&&s.minibasket.items[t].parent_element_id==e.element_id&&e.children.push(s.minibasket.items[t]);for(t=0;t<theme.basket.listeners.updateBasket.length;++t)theme.basket.listeners.updateBasket[t]({checkoutUrl:s.checkout_url,minibasket:s.minibasket,justAddedItem:e})}else{"function"==typeof i&&i(s);for(t=0;t<theme.basket.listeners.addToBasketError.length;++t)theme.basket.listeners.addToBasketError[t](s)}},600)})):console.warn("theme.basket.add(basketAddData) was called but no basketAddData was specified")},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.basket.on(eventName, callback) was called, but no callback function was given."):console.warn("theme.basket.on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}},genericContentPopup:{instances:[],init:function(){for(var e,t=document.querySelectorAll(".generic-content-popup"),s=0;s<t.length;++s)(e=this.instantiate(t[s]))&&this.instances.push(e)},instantiate:function(t){if(t)return{els:{body:null,rootEl:null,closeEls:[],triggerEls:[]},listeners:{hide:[],show:[]},init:function(){var s=this;s.els.body=document.querySelector("body"),s.els.rootEl=t,s.els.closeEls=s.els.rootEl.querySelectorAll('[data-on-click-close="true"]'),s.els.rootEl.dataset.triggerElSelector&&(s.els.triggerEls=document.querySelectorAll(s.els.rootEl.dataset.triggerElSelector)),s.hide();for(var e=0;e<s.els.triggerEls.length;++e)s.els.triggerEls[e].addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s.show()});for(e=0;e<s.els.closeEls.length;++e)s.els.closeEls[e].addEventListener("click",function(){s.hide()});return document.addEventListener("keyup",function(e){var t;window.event?t=e.keyCode:e.which?t=e.which:e.key&&(t=e.key),27==t&&s.hide()}),this},show:function(){this.els.rootEl.classList.remove("hide"),theme.utilities.disableBodyScroll();for(var e=0;e<this.listeners.show.length;++e)this.listeners.show[e]()},hide:function(){this.els.rootEl.classList.add("hide"),theme.utilities.enableBodyScroll();for(var e=0;e<this.listeners.hide.length;++e)this.listeners.hide[e]()},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.genericContentPopup.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.genericContentPopup.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init();console.warn("theme.genericContentPopup.instantiate(rootEl) was called, but no rootEl was given.")},getInstanceByRootEl:function(e){for(var t=0;t<this.instances.length;++t)if(this.instances[t].els.rootEl===e)return this.instances[t]}},newsletterSignup:{settings:{autoShowEnabled:!1,minSecondsOnSite:0},els:{showTriggers:null},genericContentPopupInstance:null,secondsOnSiteInterval:null,init:function(e){var t=this;if(e&&(this.settings=theme.utilities.extend(this.settings,e)),this.genericContentPopupInstance=theme.genericContentPopup.getInstanceByRootEl(document.querySelector(".newsletter-signup.generic-content-popup")),this.genericContentPopupInstance){this.els.showTriggers=document.querySelectorAll('[data-on-click-show-newsletter-signup="true"]');for(var s=0;s<this.els.showTriggers.length;++s)this.els.showTriggers[s].addEventListener("click",function(){t.genericContentPopupInstance&&t.genericContentPopupInstance.show()});return this.initAutoShow(),t}},initAutoShow:function(){!this.settings.autoShowEnabled||this.isDismissed()||(this.genericContentPopupInstance.on("hide",function(){localStorage.setItem("newsletter-signup-dismissed",1)}),isNaN(this.settings.minSecondsOnSite)||this.settings.minSecondsOnSite<=0||this.getSecondsOnSite()>=this.settings.minSecondsOnSite?this.genericContentPopupInstance.show():!isNaN(this.settings.minSecondsOnSite)&&0<this.settings.minSecondsOnSite&&this.getSecondsOnSite()<this.settings.minSecondsOnSite&&this.startCountingSecondsOnSite())},getSecondsOnSite:function(){var e=localStorage.getItem("newsletter-signup-seconds-on-site");return e?parseInt(e):0},setSecondsOnSite:function(e){isNaN(e)?console.warn("theme.newsletterSignup.setSecondsOnSite(value) was called, but in invalid value was provided.  Must be a numeric (int) value."):localStorage.setItem("newsletter-signup-seconds-on-site",parseInt(e))},startCountingSecondsOnSite:function(){var t=this;this.secondsOnSiteInterval=setInterval(function(){var e=parseInt(parseInt(t.getSecondsOnSite())+parseInt(1));t.setSecondsOnSite(e),e>=t.settings.minSecondsOnSite&&(t.isDismissed()||t.genericContentPopupInstance.show(),clearTimeout(t.secondsOnSiteInterval))},1e3)},isDismissed:function(){return!!localStorage.getItem("newsletter-signup-dismissed")}},mobileMenu:{els:{rootEl:null,showTriggers:null,hideTriggers:null},init:function(){var e=this;if(this.els.rootEl=document.querySelector(".mobile-menu"),this.els.rootEl){this.els.showTriggers=document.querySelectorAll("[data-on-click-show-mobile-menu]");for(var t=0;t<this.els.showTriggers.length;++t)this.els.showTriggers[t].addEventListener("click",function(){e.show()});this.els.hideTriggers=document.querySelectorAll("[data-on-click-hide-mobile-menu]");for(t=0;t<this.els.hideTriggers.length;++t)this.els.hideTriggers[t].addEventListener("click",function(){e.hide()});return this}},show:function(){this.els.rootEl.classList.add("device-s-show"),theme.utilities.disableBodyScroll()},hide:function(){this.els.rootEl.classList.remove("device-s-show"),theme.utilities.enableBodyScroll()}},mobileNav:{els:{l1as:null},init:function(){this.els.l1as=document.querySelectorAll("nav.nav-mobile a.l1");for(var e=0;e<this.els.l1as.length;++e)this.els.l1as[e].addEventListener("click",function(e){theme.utilities.hasClass(e.currentTarget,"has-subs")&&!theme.utilities.hasClass(e.currentTarget,"active")&&(e.currentTarget.classList.add("active"),e.stopPropagation(),e.preventDefault())})}},recaptcha:{settings:{sitekey:""},els:{forms:[]},loadState:"none",loadInterval:null,init:function(e){this.settings=theme.utilities.extend(this.settings,e);for(var t,n=this,s=document.querySelectorAll("form"),i=0;i<s.length;++i)(t=s[i].querySelector(".g-recaptcha"))&&(t.dataset.sitekey||this.settings.sitekey)&&this.els.forms.push(s[i]);for(var l,o=null,r=null,a=null,i=0;i<this.els.forms.length;++i){if(!(l=this.els.forms[i].querySelector("input[name=site_form_id]")))return;a=this.els.forms[i].querySelectorAll("input, select, textarea"),this.els.forms[i].id="site-form-"+l.value;var r=this.els.forms[i].querySelector(".g-recaptcha"),d=document.createElement("div");d.classList.add("scripted-recaptcha"),d.dataset.sitekey=r.dataset.sitekey||this.settings.sitekey,d.dataset.callback="onSubmit_"+l.value,d.dataset.size="invisible",d.dataset.recaptchaWidgetId="",theme.utilities.insertBefore(d,r),r.classList.remove("g-recaptcha"),r.removeAttribute("sitekey"),(o=document.createElement("script")).innerHTML+="function onSubmit_"+l.value+"(token) {",o.innerHTML+="document.getElementById('site-form-"+l.value+"').submit()",o.innerHTML+="}",theme.utilities.append(o,document.querySelector("body")),this.els.forms[i].addEventListener("submit",function(e){var t,s;"loaded"!==n.loadState?(alert("Sorry, Recaptcha is still loading... Please wait a moment and try again."),e.preventDefault()):(t=null,(s=e.target.querySelector("div.scripted-recaptcha"))&&(t=s.dataset.recaptchaWidgetId),window.grecaptcha&&!window.grecaptcha.getResponse(t)&&(e.preventDefault(),window.grecaptcha.execute(t)))});for(var c=0;c<a.length;++c)a[c].addEventListener("focus",function(e){"none"===n.loadState&&(n.loadState="loading",n.doPollForLoadedState(),theme.utilities.loadScript("https://www.google.com/recaptcha/api.js"))})}},doPollForLoadedState:function(){var e=this;e.loadInterval=setInterval(function(){window.grecaptcha&&window.grecaptcha.render&&"function"==typeof window.grecaptcha.render?(e.loadState="loaded",e.doRenderRecaptchaWidgets(),clearInterval(e.loadInterval)):console.log("loading recaptcha...")},50)},doRenderRecaptchaWidgets:function(){for(var e,t=null,s=0;s<this.els.forms.length;++s)(t=this.els.forms[s].querySelector("div.scripted-recaptcha"))&&window.grecaptcha&&window.grecaptcha.render?(e=window.grecaptcha.render(t),t.dataset.recaptchaWidgetId=e):(t||console.log("could not render recaptcha widgets, because no recpatcha div was found."),window.grecaptcha||console.log("could not render recaptcha widgets, because window.grecaptcha is undefined"),window.grecaptcha.render||console.log("could not render recaptcha widgets, because window.grecaptcha.render is undefined"))}},productData:{products:{},setProductData:function(e,t){e&&t&&(this.products[e]?this.products[e]=theme.utilities.extend(this.products[e],t):this.products[e]=t)},getProductData:function(e){return e&&this.products[e]?this.products[e]:{}}},videos:{settings:{cookieSuppressionEnabled:!1,cookieSuppressionCategory:3,cookieSuppressionWarningText:'Sorry, your cookie preferences have disabled support of YouTube videos. Please review your cookie preferences, and enable category [category], "Experience enhancement".'},instances:[],listeners:{loadYoutubeApi:[]},intersectionObserver:null,youtubeApiLoadState:"initial",init:function(e){this.settings=theme.utilities.extend(this.settings,e),this.intersectionObserver=new IntersectionObserver(this.observerCallback,{rootMargin:"0px",threshold:.1});for(var t,s=document.querySelectorAll("[data-video-url]"),n=0;n<s.length;++n)(t=this.instantiate(s[n]))&&this.instances.push(t);return this},instantiate:function(t){if(t)return{els:{root:null,img:null,iframePlaceholder:null},intersectionObserver:null,loadState:"initial",platform:null,player:null,iframeHtml:null,init:function(){var e=this;if(this.els.root=t,this.els.img=t.querySelector("img"),this.els.img)return this.platform=this.getVideoPlatform(),this.els.iframePlaceholder=document.createElement("div"),theme.utilities.append(this.els.iframePlaceholder,this.els.root),"youtube"==this.platform&&theme.videos.on("loadYoutubeApi",function(){e.onLoadYoutubeApi()}),this.els.img.addEventListener("click",function(){e.onClickImg()}),theme.videos.intersectionObserver&&theme.videos.intersectionObserver.observe(this.els.img),this},getVideoPlatform:function(){var e=this.els.root.dataset.videoUrl;if(e)return-1!==e.indexOf("youtube.com")||-1!==e.indexOf("youtu.be")||-1!==e.indexOf("youtube-nocookie.com")?"youtube":-1!==e.indexOf("vimeo.com")?"vimeo":void 0},getVideoId:function(){if("youtube"==this.platform){var e=this.els.root.dataset.videoUrl,t=(s=e.split("?"))[0].split("/");if(-1!==e.indexOf("/embed/")){if(0<s.length&&0<(e=(e=s[0]).split("/")).length)return e[e.length-1]}else if(1<s.length){for(var s=s[1].split("&"),n=0;n<s.length;++n)if("v="==s[n].substr(0,2))return s[n].substr(2)}else if(t[t.length-1]&&6<t[t.length-1].length)return t[t.length-1]}return 0},getVideoData:function(i){var e,l=this;"function"!=typeof i?console.warn("theme.videos.instance[#].getVideoData(callback) was called, but no callback was given"):"youtube"==this.platform?i({posterImageUrl:"https://img.youtube.com/vi/"+this.getVideoId()+"/hqdefault.jpg"}):"vimeo"==this.platform&&(e="https://vimeo.com/api/oembed.json?url="+this.els.root.dataset.videoUrl,e+="&autoplay=true",!theme.videos.settings.cookieSuppressionEnabled||void 0===window.cp||isNaN(theme.videos.settings.cookieSuppressionCategory)||window.cp.isCategoryAllowed(theme.videos.settings.cookieSuppressionCategory)||(e+="&dnt=true"),fetch(e,{method:"GET"}).then(function(e){return e.json()}).then(function(e){var t=e.thumbnail_url,s=e.thumbnail_width,n=e.thumbnail_height;l.els.root.dataset.videoWidth&&l.els.root.dataset.videoHeight&&(s=parseInt(l.els.root.dataset.videoWidth),n=parseInt(l.els.root.dataset.videoHeight),t=t.replace("_"+e.thumbnail_width+"x"+e.thumbnail_height,"_"+2*s+"x"+2*n)),i({posterImageUrl:t,posterImageWidth:s,posterImageHeight:n,iframeHtml:e.html})}))},onScrollToView:function(){var t=this;"initial"==this.loadState&&("youtube"==this.platform?("initial"==theme.videos.youtubeApiLoadState&&theme.videos.loadYoutubeApi(),this.getVideoData(function(e){setTimeout(function(){t.els.img.src=e.posterImageUrl,t.loadState="posterImage"},1)})):"vimeo"==this.platform&&this.getVideoData(function(e){t.els.img.src=e.posterImageUrl,e.posterImageWidth&&(t.els.img.width=e.posterImageWidth),e.posterImageHeight&&(t.els.img.height=e.posterImageHeight),e.iframeHtml&&(t.iframeHtml=e.iframeHtml),t.loadState="posterImage"}))},onLoadYoutubeApi:function(){"awaitingApi"==this.loadState&&this.platform},onClickImg:function(){var e=this;"youtube"!=e.platform||!theme.videos.settings.cookieSuppressionEnabled||void 0===window.cp||isNaN(theme.videos.settings.cookieSuppressionCategory)||window.cp.isCategoryAllowed(theme.videos.settings.cookieSuppressionCategory)?"posterImage"==this.loadState&&("youtube"==this.platform?"ready"==theme.videos.youtubeApiLoadState&&(e.player=new YT.Player(e.els.iframePlaceholder,{height:"390",width:"640",videoId:e.getVideoId(),host:"https://www.youtube-nocookie.com",playerVars:{playsinline:1,rel:0},events:{onReady:e.onYoutubePlayerReady,onStateChange:e.onYoutubePlayerStateChange}}),e.loadState="loadedVideo",e.els.root.classList.add("iframe-loaded")):"vimeo"==this.platform&&e.iframeHtml&&(e.els.iframePlaceholder.innerHTML=e.iframeHtml,e.loadState="loadedVideo",e.els.root.classList.add("iframe-loaded"))):(alert(theme.videos.settings.cookieSuppressionWarningText.replace("[category]",theme.videos.settings.cookieSuppressionCategory)),window.cp.goToPage("customize"),window.cp.showPopup())},onYoutubePlayerReady:function(e){e.target.playVideo()},onYoutubePlayerStateChange:function(e){}}.init();console.warn("theme.videos.instantiate(fauxVideoEl) was called, but no faux video element was given.")},getInstanceFromImg:function(e){for(var t=0;t<this.instances.length;++t)if(e==this.instances[t].els.img)return this.instances[t]},observerCallback:function(e,t){for(var s=null,n=0;n<e.length;++n)if(e[n].isIntersecting){if(!(s=theme.videos.getInstanceFromImg(e[n].target)))return;s.onScrollToView()}},loadYoutubeApi:function(){var e;"initial"!=this.youtubeApiLoadState?console.warn("theme.videos.loadYoutubeApi() was called but Youtube API is already loading/loaded."):(window.onYouTubeIframeAPIReady=function(){theme.videos.onYoutubeApiReady()},this.youtubeApiLoadState="loading",(e=document.createElement("script")).src="https://www.youtube.com/iframe_api",theme.utilities.append(e,document.querySelector("body")))},onYoutubeApiReady:function(){this.youtubeApiLoadState="ready";for(var e=0;e<this.listeners.loadYoutubeApi.length;++e)this.listeners.loadYoutubeApi[e]()},loadVimeoApi:function(){if("initial"!=this.vimeoApiLoadState)console.warn("theme.videos.loadVimeoApi() was called but Vimeo API is already loading/loaded.");else{this.vimeoApiLoadState="loading";for(var e=0;e<this.listeners.loadVimeoApi.length;++e)this.listeners.loadVimeoApi[e]()}},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.videos.on(eventName, callback) was called, but no callback function was given."):console.warn("theme.videos.on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}},countdownTimers:{instances:[],createTimer:function(e,t){return e&&!isNaN(e)||console.warn("theme.countdownTimers.createTimer(timestampNow, timestampEnd) was called, but no timestampNow was given"),t&&!isNaN(t)||console.warn("theme.countdownTimers.createTimer(timestampNow, timestampEnd) was called, but no timestampEnd was given"),{settings:{timestampNow:null,timestampEnd:null},elapsedTime:0,listeners:{tick:[],start:[],stop:[],expire:[]},tickInterval:null,init:function(){return this.settings.timestampNow=e,this.settings.timestampEnd=t,this},getTimeRemaining:function(){var e=parseInt(this.settings.timestampEnd)-(parseInt(this.settings.timestampNow)+this.elapsedTime);return{total:e,days:Math.floor(e/864e5),hours:Math.floor(e/36e5%24),minutes:Math.floor(e/1e3/60%60),seconds:Math.floor(e/1e3%60)}},start:function(){var e=this;this.tickInterval=setInterval(function(){e.tick()},1e3);for(var t=0;t<e.listeners.start.length;++t)e.listeners.start[t]({time:e.getTimeRemaining()})},stop:function(){clearInterval(this.tickInterval);for(var e=0;e<this.listeners.stop.length;++e)this.listeners.stop[e]({time:this.getTimeRemaining()})},tick:function(){var e=this;e.elapsedTime=e.elapsedTime+1e3;for(var t=0;t<e.listeners.tick.length;++t)e.listeners.tick[t]({time:e.getTimeRemaining()});if(e.getTimeRemaining().total<=0){e.stop();for(t=0;t<e.listeners.expire.length;++t)e.listeners.expire[t]({time:e.getTimeRemaining()})}},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.countdownTimers.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.countdownTimers.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init()}},expandables:{settings:{supportLazyLoad:!0,expandTimeMs:600,indicateOverflow:!1,toggleEnabled:!0,toggleElementType:"span",toggleExpandText:'show&nbsp;more&nbsp;<i class="icon xs chevron-down"></i>',toggleCollapseText:'show&nbsp;less&nbsp;<i class="icon xs chevron-up"></i>',toggleClassName:"expandable-toggle",breakpointDeviceS:1,breakpointDeviceM:768,breakpointDeviceL:1200,breakpointDeviceXl:1600},instances:[],init:function(e){this.settings=theme.utilities.extend(this.settings,e);for(var t,s=document.querySelectorAll("[data-max-height], [data-device-s-max-height], [data-device-m-max-height], [data-device-l-max-height], [data-device-xl-max-height]"),n=0;n<s.length;++n)(t=this.instantiate(s[n]))&&this.instances.push(t);return this},instantiate:function(s){if(s&&!(s.length<=0))return{els:{rootEl:null,toggle:null,customToggles:[]},listeners:{calculateHeight:[]},resizeTimeout:null,expandTimeout:null,calculatedHeight:0,calculatedHeightThreshold:0,state:null,init:function(){var t=this;t.els.rootEl=s,t.els.customToggles=t.els.rootEl.querySelectorAll(".expandable-custom-toggle"),theme.expandables.settings.indicateOverflow&&t.els.rootEl.classList.add("expandable-indicate-overflow"),theme.expandables.settings.toggleEnabled&&(t.els.toggle=document.createElement(theme.expandables.settings.toggleElementType),t.els.toggle.innerHTML="expand/collapse",t.els.toggle.classList.add(theme.expandables.settings.toggleClassName||"expandable-toggle"),theme.utilities.insertAfter(t.els.toggle,t.els.rootEl)),t.on("calculateHeight",function(e){e.maxHeight<=0||e.newHeight<e.maxHeightIncThreshold?t.els.rootEl.classList.add("expandable-within-threshold"):t.els.rootEl.classList.remove("expandable-within-threshold")}),window.addEventListener("resize",function(){clearTimeout(t.resizeTimeout),t.resizeTimeout=setTimeout(function(){t.setCalculatedExpandedHeight(),setTimeout(function(){var e=t.getMaxHeight();t.els.rootEl.style.maxHeight=e<=0?"none":e+"px"},10)},50)}),theme.expandables.settings.toggleEnabled&&t.els.toggle.addEventListener("click",function(e){t.setState("collapsed"==t.getState()?"expanded":"collapsed")});for(var e=0;e<t.els.customToggles.length;++e)t.els.customToggles[e].addEventListener("click",function(e){t.setState("collapsed"==t.getState()?"expanded":"collapsed")});return t.setCalculatedExpandedHeight(),t.setState("collapsed"),t},getState:function(){return this.state},getCalculatedHeight:function(){return this.calculatedHeight},getCalculatedHeightThreshold:function(){return this.calculatedHeightThreshold},getMaxHeight:function(){var e=window.innerWidth,t=parseInt(this.els.rootEl.dataset.deviceSMaxHeight),s=parseInt(this.els.rootEl.dataset.deviceMMaxHeight),n=parseInt(this.els.rootEl.dataset.deviceLMaxHeight),i=parseInt(this.els.rootEl.dataset.deviceXlMaxHeight),l=parseInt(this.els.rootEl.dataset.maxHeight);return e>=theme.expandables.settings.breakpointDeviceXl?!isNaN(i)&&0<i?i:isNaN(l)?0:l:e>=theme.expandables.settings.breakpointDeviceL?!isNaN(n)&&0<n?n:isNaN(l)?0:l:e>=theme.expandables.settings.breakpointDeviceM?!isNaN(s)&&0<s?s:isNaN(l)?0:l:e>=theme.expandables.settings.breakpointDeviceS&&!isNaN(t)&&0<t?t:isNaN(l)?0:l},setState:function(e){var t=["expanded","collapsed"];-1===t.indexOf(e)?console.error("theme.expandables.instances[#].setState(state) was called, but an invalid state was given. Valid states are: "+t.join(", ")):e!=this.state&&(this.state=e,"expanded"==this.state?this.doExpand():this.doCollapse())},doCollapse:function(){var t=this;t.els.rootEl.classList.remove("expandable-expanded"),t.els.rootEl.classList.add("expandable-collapsed"),t.els.rootEl.style.overflow="hidden",clearTimeout(t.expandTimeout),theme.expandables.settings.supportLazyLoad&&t.els.rootEl.classList.remove("expandable-expanded-complete"),setTimeout(function(){var e=t.getMaxHeight();t.els.rootEl.style.maxHeight=e<=0?"none":t.getMaxHeight()+"px"},10),theme.expandables.settings.toggleEnabled&&(t.els.toggle.innerHTML=theme.expandables.settings.toggleExpandText)},doExpand:function(e){var t=this;(!e||isNaN(e)||e<this.getMaxHeight())&&(e=this.getCalculatedHeight()),clearTimeout(t.expandTimeout),t.els.rootEl.style.maxHeight=e+"px",t.els.rootEl.classList.remove("expandable-collapsed"),t.els.rootEl.classList.add("expandable-expanded"),t.els.toggle.innerHTML=theme.expandables.settings.toggleCollapseText,theme.expandables.settings.supportLazyLoad&&!isNaN(theme.expandables.settings.expandTimeMs)&&0<theme.expandables.settings.expandTimeMs&&(t.expandTimeout=setTimeout(function(){t.els.rootEl.classList.add("expandable-expanded-complete"),t.setCalculatedExpandedHeight(),t.els.rootEl.style.maxHeight=t.getCalculatedHeight()+"px"},theme.expandables.settings.expandTimeMs+10))},setCalculatedExpandedHeight:function(){var e=this,t=e.calculatedHeight;e.els.rootEl.classList.add("expandable-recalculating"),e.calculatedHeight=e.els.rootEl.offsetHeight,e.els.rootEl.classList.remove("expandable-recalculating");for(var s=0;s<e.listeners.calculateHeight.length;++s)e.listeners.calculateHeight[s]({oldHeight:t,newHeight:e.calculatedHeight,maxHeight:e.getMaxHeight(),maxHeightIncThreshold:e.getMaxHeight()+e.getCalculatedHeightThreshold()})},on:function(e,t){e&&this.listeners[e]?t&&"function"==typeof t?this.listeners[e].push(t):console.warn("theme.expandables.instances[#].on(eventName, callback) was called, but no callback function was given."):console.warn("theme.expandables.instances[#].on(eventName, callback) was called, but an invalid eventName ("+e+") was given.")}}.init()}},contentTriggers:{instances:[],init:function(){for(var e,t=document.querySelectorAll("[data-on-click-toggle-el]"),s=0;s<t.length;++s)(e=this.instantiate(t[s]))&&this.instances.push(e);return this},instantiate:function(e){return{els:{rootEl:e,targetEls:[]},active:!1,init:function(){var e=this;if(this.els.rootEl.dataset.onClickToggleEl){if(this.els.targetEls=document.querySelectorAll(this.els.rootEl.dataset.onClickToggleEl),!(this.els.targetEls.length<=0))return this.els.rootEl.addEventListener("click",function(){e.handleClickTrigger()}),this.hideTargets(),this;console.warn("theme.contentTriggers.intantiate(rootEl) was called, but no target els were found")}else console.warn("theme.contentTriggers.intantiate(rootEl) was called, but no data-on-click-toggle-el was set on trigger element.")},isToggle:function(){return"true"==this.els.rootEl.dataset.isToggle},handleClickTrigger:function(){this.isToggle()?(this.active?this.hideTargets():this.showTargets(),this.active=!this.active):(this.hideTrigger(),this.showTargets())},showTargets:function(){for(var e=0;e<this.els.targetEls.length;++e)this.els.targetEls[e].classList.remove("force-hide")},hideTargets:function(){for(var e=0;e<this.els.targetEls.length;++e)this.els.targetEls[e].classList.add("force-hide")},hideTrigger:function(){this.els.rootEl.classList.add("force-hide")}}.init()}}};